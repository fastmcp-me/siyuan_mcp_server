# ÊÄùÊ∫êÁ¨îËÆ∞ MCP ÊúçÂä°Âô® / SiYuan MCP Server

<div align="center">

[English](#english-version) | [‰∏≠Êñá](#‰∏≠ÊñáÁâàÊú¨)

</div>

---

## English Version

A Model Context Protocol (MCP) server for SiYuan Note, providing complete SiYuan API functionality.

### üöÄ Quick Start

#### 1. Clone the repository
```bash
git clone https://github.com/xgq18237/siyuan_mcp_server.git
cd siyuan_mcp_server
```

#### 2. Install dependencies
```bash
npm install
```

#### 3. Build the project
```bash
npm run build
```

#### 4. Docker deployment

1. **Build image**
```bash
docker build -t siyuan-mcp-server .
```

2. **Run container (recommended with environment variables)**
```bash
docker run -d \
  -e SIYUAN_HOST=127.0.0.1 \
  -e SIYUAN_PORT=6806 \
  -e SIYUAN_TOKEN=your-api-token \
  --name siyuan-mcp-server \
  siyuan-mcp-server
```

3. **View logs**
```bash
docker logs -f siyuan-mcp-server
```

4. **Stop and remove container**
```bash
docker stop siyuan-mcp-server && docker rm siyuan-mcp-server
```

##### Docker Compose (Recommended)

1. **Configure environment variables**
```bash
# Copy environment template
cp env.example .env

# Edit .env file with your SiYuan configuration
# SIYUAN_HOST=127.0.0.1
# SIYUAN_PORT=6806
# SIYUAN_TOKEN=your-api-token
```

2. **Start service**
```bash
docker-compose up -d
```

3. **View logs**
```bash
docker-compose logs -f
```

4. **Stop service**
```bash
docker-compose down
```

#### 5. Get SiYuan API token

1. **Open SiYuan Note**
2. **Go to Settings**:
   - Click the menu icon in the top left
   - Select `Settings`
3. **Find API Token**:
   - Click `About` in the settings page
   - Find the `API Token` option
4. **Copy token**:
   - Click `Generate Token` or copy existing token
   - Save the token (you'll need it later)

#### 6. Configure MCP client

##### Cursor Configuration

1. **Open Cursor settings**:
   - Press `Ctrl/Cmd + ,` to open settings
   - Search for "MCP" or "Model Context Protocol"

2. **Add MCP configuration**:
   - Find MCP configuration options
   - Click "Add Server" or "Add Server"

3. **Configure server information**:
```json
{
  "mcpServers": {
    "siyuan-mcp": {
      "command": "node",
      "args": ["./dist/index.js"],
      "env": {
        "SIYUAN_HOST": "127.0.0.1",
        "SIYUAN_PORT": "6806",
        "SIYUAN_TOKEN": "your-api-token-here"
      }
    }
  }
}
```

4. **Replace token**:
   - Replace `your-api-token-here` with the token you obtained in step 5

5. **Restart Cursor**:
   - Completely close Cursor
   - Restart

##### Other MCP Client Configuration

If you use other MCP-compatible clients, the configuration is similar:

```json
{
  "mcpServers": {
    "siyuan-mcp": {
      "command": "node",
      "args": ["path/to/siyuan_mcp_server/dist/index.js"],
      "env": {
        "SIYUAN_HOST": "127.0.0.1",
        "SIYUAN_PORT": "6806",
        "SIYUAN_TOKEN": "your-api-token-here"
      }
    }
  }
}
```

**Note**: Replace `path/to/siyuan_mcp_server` with your actual project path.

#### 7. Verify connection

After configuration, you can verify the connection by:

1. **Test in Cursor**:
   - Open a new chat window
   - Type: `List all notebooks`
   - If it returns a notebook list, the connection is successful

2. **Use status check**:
   - Type: `Check SiYuan status`
   - View the returned status information

### üîß Environment Variables

| Variable | Description | Default | Required |
|----------|-------------|---------|----------|
| `SIYUAN_HOST` | SiYuan server address | 127.0.0.1 | No |
| `SIYUAN_PORT` | SiYuan server port | 6806 | No |
| `SIYUAN_TOKEN` | API token | - | Yes |

### üìã Common Issues

#### Q: What if the connection fails?
**A:** Please check the following steps:
1. Ensure SiYuan Note is running
2. Check if the API token is correct
3. Confirm there are open notebooks in SiYuan Note
4. Restart SiYuan Note and Cursor

#### Q: How to get the correct API token?
**A:** 
1. Open SiYuan Note
2. Go to `Settings` ‚Üí `About` ‚Üí `API Token`
3. Click `Generate Token` or copy existing token
4. Ensure the token format is correct (usually a string of alphanumeric characters)

#### Q: What if the project path configuration is wrong?
**A:** 
1. Ensure the project path is correct
2. Use absolute path or relative path
3. Check if the `dist/index.js` file exists

### üéØ Features

#### üìö Notebook Management (8 APIs)
Notebooks are the basic organizational units of SiYuan Note, each containing multiple documents.

- **`list_notebooks`** - List all notebooks, get notebook IDs and names
- **`open_notebook`** - Open specified notebook, activate workspace
- **`close_notebook`** - Close specified notebook, release resources
- **`rename_notebook`** - Rename notebook, update display name
- **`create_notebook`** - Create new notebook, support custom names
- **`remove_notebook`** - Delete notebook, clean related data
- **`get_notebook_conf`** - Get notebook configuration information
- **`set_notebook_conf`** - Save notebook configuration, custom settings

#### üìÑ Document Management (11 APIs)
Documents are specific content units in notebooks, supporting hierarchical structure and path management.

- **`create_doc`** - Create new document in specified notebook, support Markdown content
- **`rename_doc`** - Rename document, keep content unchanged
- **`rename_doc_by_id`** - Rename by document ID, precise operation
- **`remove_doc`** - Delete document, clean file system
- **`remove_doc_by_id`** - Delete by document ID, precise operation
- **`move_docs`** - Move documents to other locations or notebooks
- **`move_docs_by_id`** - Move by document ID, precise operation
- **`get_hpath_by_path`** - Get human-readable path by path
- **`get_hpath_by_id`** - Get human-readable path by ID
- **`get_path_by_id`** - Get storage path by ID
- **`get_ids_by_hpath`** - Get IDs by human-readable path

#### üß© Block Operations (11 APIs)
Blocks are the smallest content units in SiYuan Note, supporting flexible editing, reorganization, and referencing.

- **`insert_block`** - Insert block, support specified position and data type
- **`prepend_block`** - Insert prepend child block, add content at parent block beginning
- **`append_block`** - Insert append child block, add content at parent block end
- **`update_block`** - Update block content, support Markdown and DOM formats
- **`delete_block`** - Delete block, clean related references
- **`move_block`** - Move block to new position, support hierarchical adjustment
- **`get_block_kramdown`** - Get block kramdown source code, for export
- **`get_child_blocks`** - Get child block list, traverse block structure
- **`fold_block`** - Fold block, hide child content
- **`unfold_block`** - Unfold block, show child content
- **`transfer_block_ref`** - Transfer block reference, maintain reference relationships

#### üè∑Ô∏è Attribute Operations (2 APIs)
Block attributes are used to store metadata and custom information, supporting key-value pair storage.

- **`set_block_attrs`** - Set block attributes, support custom key-value pairs
- **`get_block_attrs`** - Get block attributes, read metadata information

#### üîç Search and Query (2 APIs)
Get data from SiYuan Note through SQL queries, supporting complex query conditions.

- **`sql_query`** - Execute SQL queries, support all SQLite syntax
- **`flush_transaction`** - Commit transactions, ensure data persistence

#### üìÅ File Operations (5 APIs)
Manage files and directories in SiYuan Note workspace, support resource management.

- **`get_file`** - Get file content, read file data
- **`remove_file`** - Delete file, clean storage space
- **`rename_file`** - Rename file, update file path
- **`read_dir`** - List directory content, browse file structure
- **`put_file`** - Write file, create or update file content

#### üì§ Export Functions (2 APIs)
Export SiYuan Note content to various formats, support backup and sharing.

- **`export_md_content`** - Export Markdown text, maintain format
- **`export_resources`** - Export files and directories, include resource files

#### üì¢ Notification Functions (2 APIs)
Push messages and error prompts to users, provide operation feedback.

- **`push_msg`** - Push messages, display success prompts
- **`push_err_msg`** - Push error messages, display error information

#### üíª System Information (5 APIs)
Get SiYuan Note system status and runtime information, monitor system health.

- **`get_version`** - Get SiYuan Note version information
- **`get_current_time`** - Get system current time
- **`get_boot_progress`** - Get boot progress, monitor boot status
- **`check_siyuan_status`** - Check SiYuan Note status and API availability
- **`get_workspace_info`** - Get workspace and connection information

#### üé® Template Functions (2 APIs)
Use template system to create dynamic content, support variable substitution.

- **`render_template`** - Render template files, support external templates
- **`render_sprig`** - Render Sprig templates, support inline template syntax

#### üîÑ Conversion Functions (1 API)
Use Pandoc for document format conversion, support multiple output formats.

- **`pandoc_convert`** - Pandoc conversion, support multiple document formats

#### üìé Resource Files (1 API)
Manage resource files in SiYuan Note, support batch upload.

- **`upload_asset`** - Upload resource files, support batch operations

### üîß Core Features

#### üöÄ High Performance
- **Asynchronous Processing**: All API calls use asynchronous processing for faster response
- **Batch Operations**: Support batch document movement and block operations for improved efficiency
- **Transaction Management**: Built-in transaction mechanism ensures data consistency

#### üõ°Ô∏è Secure and Reliable
- **Authentication**: Support API token authentication to protect data security
- **Error Handling**: Comprehensive error handling mechanism provides detailed error information
- **Parameter Validation**: Strict parameter validation prevents invalid operations

#### üîå Easy Integration
- **MCP Protocol**: Based on Model Context Protocol, easy to integrate with AI tools
- **Standard Interface**: Follows SiYuan Note official API specifications
- **Multi-language Support**: Supports Chinese and English documentation and error messages

#### üìä Data Management
- **Complete CRUD**: Support create, read, update, delete for all data types
- **Hierarchical Structure**: Support hierarchical organization of documents and blocks
- **Reference System**: Support block references and transfers, maintain data relationships

#### üéØ Developer Friendly
- **Detailed Logging**: Provide detailed API call logs for easy debugging
- **Status Checking**: Built-in connection status checking for quick problem diagnosis
- **Rich Examples**: Provide complete usage examples and best practices

### üìä API Statistics

- **Total APIs**: 49
- **Feature Modules**: 12
- **Supported Operations**: Complete SiYuan Note API functionality
- **Coverage**: 100% SiYuan Note official API (except network APIs)

### üìö Usage Examples

#### Basic Operations

**List all notebooks**
```json
{
  "name": "list_notebooks",
  "arguments": {}
}
```

**Create new document**
```json
{
  "name": "create_doc",
  "arguments": {
    "notebook": "20241009135857-599ipbh",
    "path": "/daily/2025-01-15",
    "markdown": "# Today's Summary\n\nToday I completed the following work:\n- Project development\n- Document writing"
  }
}
```

**Execute SQL query**
```json
{
  "name": "sql_query",
  "arguments": {
    "sql": "SELECT * FROM blocks WHERE type = 'd' ORDER BY created DESC LIMIT 5"
  }
}
```

**Insert block**
```json
{
  "name": "insert_block",
  "arguments": {
    "data": "This is new block content",
    "dataType": "markdown",
    "parentID": "20250803150424-tu1cl78"
  }
}
```

**Set block attributes**
```json
{
  "name": "set_block_attrs",
  "arguments": {
    "id": "20250803150424-tu1cl78",
    "attrs": {
      "custom-status": "active",
      "custom-tag": "important"
    }
  }
}
```

#### Advanced Operations

**Check SiYuan status**
```json
{
  "name": "check_siyuan_status",
  "arguments": {}
}
```

**Get workspace information**
```json
{
  "name": "get_workspace_info",
  "arguments": {}
}
```

**Batch move documents**
```json
{
  "name": "move_docs",
  "arguments": {
    "fromPaths": ["/daily/2025-01-14", "/daily/2025-01-13"],
    "toNotebook": "20241009135857-599ipbh",
    "toPath": "/archive/2025-01"
  }
}
```

**Export document content**
```json
{
  "name": "export_md_content",
  "arguments": {
    "id": "20250115123456-abcdef"
  }
}
```

**Use template rendering**
```json
{
  "name": "render_sprig",
  "arguments": {
    "template": "Hello {{.name}}! Today is {{.date}}. Your tasks: {{range .tasks}}- {{.}}\n{{end}}"
  }
}
```

**Upload resource files**
```json
{
  "name": "upload_asset",
  "arguments": {
    "assetsDirPath": "/assets/images",
    "files": ["screenshot.png", "diagram.svg", "document.pdf"]
  }
}
```

#### Common SQL Query Examples

**Get recently created documents**
```sql
SELECT * FROM blocks WHERE type = 'd' ORDER BY created DESC LIMIT 10
```

**Find blocks with specific tags**
```sql
SELECT * FROM blocks WHERE content LIKE '%#important%' OR content LIKE '%#urgent%'
```

**Count blocks by type**
```sql
SELECT type, COUNT(*) as count FROM blocks GROUP BY type
```

**Find blocks with empty content**
```sql
SELECT * FROM blocks WHERE content = '' OR content IS NULL
```

**Get content within specific time range**
```sql
SELECT * FROM blocks WHERE created >= '2025-01-01' AND created <= '2025-01-31'
```

### üìö Development Resources

#### Related Links
- [SiYuan Note Official Documentation](https://b3log.org/siyuan/)
- [SiYuan Note API Documentation](https://github.com/siyuan-note/siyuan/blob/master/API_zh_CN.md)
- [Model Context Protocol](https://modelcontextprotocol.io/)

#### Community Support
- [SiYuan Note Community](https://b3log.org/siyuan/)
- [GitHub Issues](https://github.com/xgq18237/siyuan_mcp_server/issues)

#### Technology Stack
- **Language**: TypeScript/JavaScript
- **Protocol**: Model Context Protocol (MCP)
- **Framework**: @modelcontextprotocol/sdk
- **Deployment**: Docker, Node.js
- **Database**: SQLite (via SiYuan Note)

#### Development Tools
- **Editor**: VS Code, Cursor
- **Build Tool**: TypeScript Compiler
- **Package Manager**: npm
- **Containerization**: Docker, Docker Compose

### üîß Advanced Features

#### 1. Template System
Use `render_template` and `render_sprig` to create dynamic content:
```json
{
  "name": "render_sprig",
  "arguments": {
    "template": "Hello {{.name}}! Today is {{.date}}."
  }
}
```

#### 2. File Management
Use file operation APIs to manage attachments and resources:
```json
{
  "name": "upload_asset",
  "arguments": {
    "assetsDirPath": "/assets",
    "files": ["image1.jpg", "document.pdf"]
  }
}
```

#### 3. Data Export
Use export functions to backup and share content:
```json
{
  "name": "export_md_content",
  "arguments": {
    "id": "20250115123456-abcdef"
  }
}
```

#### 4. Batch Operations
Support batch document and block operations for improved efficiency:
```json
{
  "name": "move_docs",
  "arguments": {
    "fromPaths": ["/doc1", "/doc2", "/doc3"],
    "toNotebook": "notebook-id",
    "toPath": "/archive"
  }
}
```

#### 5. Status Monitoring
Real-time monitoring of SiYuan Note system status:
```json
{
  "name": "check_siyuan_status",
  "arguments": {}
}
```

### Documentation

For detailed documentation, see the [Chinese version](#‰∏≠ÊñáÁâàÊú¨) below.

---

## ‰∏≠ÊñáÁâàÊú¨

ËøôÊòØ‰∏Ä‰∏™Âü∫‰∫é [Model Context Protocol (MCP)](https://modelcontextprotocol.io/) ÁöÑÊÄùÊ∫êÁ¨îËÆ∞ÊúçÂä°Âô®ÔºåÊèê‰æõ‰∫ÜÂÆåÊï¥ÁöÑÊÄùÊ∫êÁ¨îËÆ∞ API ÂäüËÉΩ„ÄÇ

### üöÄ Âø´ÈÄüÂºÄÂßã

#### 1. ÂÖãÈöÜÈ°πÁõÆ
```bash
git clone https://github.com/xgq18237/siyuan_mcp_server.git
cd siyuan_mcp_server
```

#### 2. ÂÆâË£Ö‰æùËµñ
```bash
npm install
```

#### 3. ÊûÑÂª∫È°πÁõÆ
```bash
npm run build
```

#### 4. Docker ÈÉ®ÁΩ≤ÊñπÂºè

1. ÊûÑÂª∫ÈïúÂÉè
```bash
docker build -t siyuan-mcp-server .
```

2. ËøêË°åÂÆπÂô®ÔºàÊé®Ëçê‰ΩøÁî®ÁéØÂ¢ÉÂèòÈáè‰º†ÈÄíÊÄùÊ∫êÂèÇÊï∞Ôºâ
```bash
docker run -d \
  -e SIYUAN_HOST=127.0.0.1 \
  -e SIYUAN_PORT=6806 \
  -e SIYUAN_TOKEN=‰Ω†ÁöÑÊÄùÊ∫êAPI‰ª§Áâå \
  --name siyuan-mcp-server \
  siyuan-mcp-server
```

3. Êü•ÁúãÊó•Âøó
```bash
docker logs -f siyuan-mcp-server
```

4. ÂÅúÊ≠¢Âπ∂Âà†Èô§ÂÆπÂô®
```bash
docker stop siyuan-mcp-server && docker rm siyuan-mcp-server
```

##### Docker Compose ÊñπÂºèÔºàÊé®ËçêÔºâ

1. ÈÖçÁΩÆÁéØÂ¢ÉÂèòÈáè
```bash
# Â§çÂà∂ÁéØÂ¢ÉÂèòÈáèÊ®°Êùø
cp env.example .env

# ÁºñËæë .env Êñá‰ª∂ÔºåÂ°´ÂÖ•‰Ω†ÁöÑÊÄùÊ∫êÁ¨îËÆ∞ÈÖçÁΩÆ
# SIYUAN_HOST=127.0.0.1
# SIYUAN_PORT=6806
# SIYUAN_TOKEN=‰Ω†ÁöÑÊÄùÊ∫êAPI‰ª§Áâå
```

2. ÂêØÂä®ÊúçÂä°
```bash
docker-compose up -d
```

3. Êü•ÁúãÊó•Âøó
```bash
docker-compose logs -f
```

4. ÂÅúÊ≠¢ÊúçÂä°
```bash
docker-compose down
```

#### 5. Ëé∑ÂèñÊÄùÊ∫êÁ¨îËÆ∞ API ‰ª§Áâå

1. **ÊâìÂºÄÊÄùÊ∫êÁ¨îËÆ∞**
2. **ËøõÂÖ•ËÆæÁΩÆ**Ôºö
   - ÁÇπÂáªÂ∑¶‰∏äËßíËèúÂçïÂõæÊ†á
   - ÈÄâÊã© `ËÆæÁΩÆ`
3. **ÊâæÂà∞ API ‰ª§Áâå**Ôºö
   - Âú®ËÆæÁΩÆÈ°µÈù¢‰∏≠ÁÇπÂáª `ÂÖ≥‰∫é`
   - ÊâæÂà∞ `API ‰ª§Áâå` ÈÄâÈ°π
4. **Â§çÂà∂‰ª§Áâå**Ôºö
   - ÁÇπÂáª `ÁîüÊàê‰ª§Áâå` ÊàñÂ§çÂà∂Áé∞Êúâ‰ª§Áâå
   - ‰øùÂ≠ò‰ª§ÁâåÔºàÁ®çÂêéÈúÄË¶ÅÁî®Âà∞Ôºâ

#### 6. ÈÖçÁΩÆ MCP ÂÆ¢Êà∑Á´Ø

##### Cursor ÈÖçÁΩÆ

1. **ÊâìÂºÄ Cursor ËÆæÁΩÆ**Ôºö
   - Êåâ `Ctrl/Cmd + ,` ÊâìÂºÄËÆæÁΩÆ
   - ÊêúÁ¥¢ "MCP" Êàñ "Model Context Protocol"

2. **Ê∑ªÂä† MCP ÈÖçÁΩÆ**Ôºö
   - ÊâæÂà∞ MCP ÈÖçÁΩÆÈÄâÈ°π
   - ÁÇπÂáª "Add Server" Êàñ "Ê∑ªÂä†ÊúçÂä°Âô®"

3. **ÈÖçÁΩÆÊúçÂä°Âô®‰ø°ÊÅØ**Ôºö
```json
{
  "mcpServers": {
    "siyuan-mcp": {
      "command": "node",
      "args": ["./dist/index.js"],
      "env": {
        "SIYUAN_HOST": "127.0.0.1",
        "SIYUAN_PORT": "6806",
        "SIYUAN_TOKEN": "your-api-token-here"
      }
    }
  }
}
```

4. **ÊõøÊç¢‰ª§Áâå**Ôºö
   - Â∞Ü `your-api-token-here` ÊõøÊç¢‰∏∫‰Ω†Âú®Ê≠•È™§ 5 ‰∏≠Ëé∑ÂèñÁöÑ‰ª§Áâå

5. **ÈáçÂêØ Cursor**Ôºö
   - ÂÆåÂÖ®ÂÖ≥Èó≠ Cursor
   - ÈáçÊñ∞ÂêØÂä®

##### ÂÖ∂‰ªñ MCP ÂÆ¢Êà∑Á´ØÈÖçÁΩÆ

Â¶ÇÊûú‰Ω†‰ΩøÁî®ÂÖ∂‰ªñÊîØÊåÅ MCP ÁöÑÂÆ¢Êà∑Á´ØÔºåÈÖçÁΩÆÊñπÂºèÁ±ª‰ººÔºö

```json
{
  "mcpServers": {
    "siyuan-mcp": {
      "command": "node",
      "args": ["path/to/siyuan_mcp_server/dist/index.js"],
      "env": {
        "SIYUAN_HOST": "127.0.0.1",
        "SIYUAN_PORT": "6806",
        "SIYUAN_TOKEN": "your-api-token-here"
      }
    }
  }
}
```

**Ê≥®ÊÑè**ÔºöÂ∞Ü `path/to/siyuan_mcp_server` ÊõøÊç¢‰∏∫‰Ω†ÁöÑÂÆûÈôÖÈ°πÁõÆË∑ØÂæÑ„ÄÇ

#### 7. È™åËØÅËøûÊé•

ÈÖçÁΩÆÂÆåÊàêÂêéÔºå‰Ω†ÂèØ‰ª•ÈÄöËøá‰ª•‰∏ãÊñπÂºèÈ™åËØÅËøûÊé•Ôºö

1. **Âú® Cursor ‰∏≠ÊµãËØï**Ôºö
   - ÊâìÂºÄ‰∏Ä‰∏™Êñ∞ÁöÑËÅäÂ§©Á™óÂè£
   - ËæìÂÖ•Ôºö`ÂàóÂá∫ÊâÄÊúâÁ¨îËÆ∞Êú¨`
   - Â¶ÇÊûúËøîÂõûÁ¨îËÆ∞Êú¨ÂàóË°®ÔºåËØ¥ÊòéËøûÊé•ÊàêÂäü

2. **‰ΩøÁî®Áä∂ÊÄÅÊ£ÄÊü•**Ôºö
   - ËæìÂÖ•Ôºö`Ê£ÄÊü•ÊÄùÊ∫êÁ¨îËÆ∞Áä∂ÊÄÅ`
   - Êü•ÁúãËøîÂõûÁöÑÁä∂ÊÄÅ‰ø°ÊÅØ

### üîß ÁéØÂ¢ÉÂèòÈáèÈÖçÁΩÆ

| ÂèòÈáèÂêç | ËØ¥Êòé | ÈªòËÆ§ÂÄº | ÂøÖÈúÄ |
|--------|------|--------|------|
| `SIYUAN_HOST` | ÊÄùÊ∫êÁ¨îËÆ∞ÊúçÂä°Âô®Âú∞ÂùÄ | 127.0.0.1 | Âê¶ |
| `SIYUAN_PORT` | ÊÄùÊ∫êÁ¨îËÆ∞ÊúçÂä°Âô®Á´ØÂè£ | 6806 | Âê¶ |
| `SIYUAN_TOKEN` | API ‰ª§Áâå | - | ÊòØ |

### üìã Â∏∏ËßÅÈóÆÈ¢ò

#### Q: ËøûÊé•Â§±Ë¥•ÊÄé‰πàÂäûÔºü
**A:** ËØ∑Êåâ‰ª•‰∏ãÊ≠•È™§Ê£ÄÊü•Ôºö
1. Á°Æ‰øùÊÄùÊ∫êÁ¨îËÆ∞Ê≠£Âú®ËøêË°å
2. Ê£ÄÊü• API ‰ª§ÁâåÊòØÂê¶Ê≠£Á°Æ
3. Á°ÆËÆ§ÊÄùÊ∫êÁ¨îËÆ∞‰∏≠ÊúâÊâìÂºÄÁöÑÁ¨îËÆ∞Êú¨
4. ÈáçÂêØÊÄùÊ∫êÁ¨îËÆ∞Âíå Cursor

#### Q: Â¶Ç‰ΩïËé∑ÂèñÊ≠£Á°ÆÁöÑ API ‰ª§ÁâåÔºü
**A:** 
1. ÊâìÂºÄÊÄùÊ∫êÁ¨îËÆ∞
2. ËøõÂÖ• `ËÆæÁΩÆ` ‚Üí `ÂÖ≥‰∫é` ‚Üí `API ‰ª§Áâå`
3. ÁÇπÂáª `ÁîüÊàê‰ª§Áâå` ÊàñÂ§çÂà∂Áé∞Êúâ‰ª§Áâå
4. Á°Æ‰øù‰ª§ÁâåÊ†ºÂºèÊ≠£Á°ÆÔºàÈÄöÂ∏∏ÊòØ‰∏Ä‰∏≤Â≠óÊØçÊï∞Â≠óÁªÑÂêàÔºâ

#### Q: È°πÁõÆË∑ØÂæÑÈÖçÁΩÆÈîôËØØÊÄé‰πàÂäûÔºü
**A:** 
1. Á°Æ‰øùÈ°πÁõÆË∑ØÂæÑÊ≠£Á°Æ
2. ‰ΩøÁî®ÁªùÂØπË∑ØÂæÑÊàñÁõ∏ÂØπË∑ØÂæÑ
3. Ê£ÄÊü• `dist/index.js` Êñá‰ª∂ÊòØÂê¶Â≠òÂú®

### üéØ ÂäüËÉΩÁâπÊÄß

#### üìö Á¨îËÆ∞Êú¨ÁÆ°ÁêÜ (8‰∏™Êé•Âè£)
Á¨îËÆ∞Êú¨ÊòØÊÄùÊ∫êÁ¨îËÆ∞ÁöÑÂü∫Êú¨ÁªÑÁªáÂçï‰ΩçÔºåÊØè‰∏™Á¨îËÆ∞Êú¨ÂåÖÂê´Â§ö‰∏™ÊñáÊ°£„ÄÇ

- **`list_notebooks`** - ÂàóÂá∫ÊâÄÊúâÁ¨îËÆ∞Êú¨ÔºåËé∑ÂèñÁ¨îËÆ∞Êú¨IDÂíåÂêçÁß∞
- **`open_notebook`** - ÊâìÂºÄÊåáÂÆöÁ¨îËÆ∞Êú¨ÔºåÊøÄÊ¥ªÂ∑•‰ΩúÁ©∫Èó¥
- **`close_notebook`** - ÂÖ≥Èó≠ÊåáÂÆöÁ¨îËÆ∞Êú¨ÔºåÈáäÊîæËµÑÊ∫ê
- **`rename_notebook`** - ÈáçÂëΩÂêçÁ¨îËÆ∞Êú¨ÔºåÊõ¥Êñ∞ÊòæÁ§∫ÂêçÁß∞
- **`create_notebook`** - ÂàõÂª∫Êñ∞Á¨îËÆ∞Êú¨ÔºåÊîØÊåÅËá™ÂÆö‰πâÂêçÁß∞
- **`remove_notebook`** - Âà†Èô§Á¨îËÆ∞Êú¨ÔºåÊ∏ÖÁêÜÁõ∏ÂÖ≥Êï∞ÊçÆ
- **`get_notebook_conf`** - Ëé∑ÂèñÁ¨îËÆ∞Êú¨ÈÖçÁΩÆ‰ø°ÊÅØ
- **`set_notebook_conf`** - ‰øùÂ≠òÁ¨îËÆ∞Êú¨ÈÖçÁΩÆÔºåËá™ÂÆö‰πâËÆæÁΩÆ

#### üìÑ ÊñáÊ°£ÁÆ°ÁêÜ (11‰∏™Êé•Âè£)
ÊñáÊ°£ÊòØÁ¨îËÆ∞Êú¨‰∏≠ÁöÑÂÖ∑‰ΩìÂÜÖÂÆπÂçïÂÖÉÔºåÊîØÊåÅÂ±ÇÁ∫ßÁªìÊûÑÂíåË∑ØÂæÑÁÆ°ÁêÜ„ÄÇ

- **`create_doc`** - Âú®ÊåáÂÆöÁ¨îËÆ∞Êú¨‰∏≠Êñ∞Âª∫ÊñáÊ°£ÔºåÊîØÊåÅMarkdownÂÜÖÂÆπ
- **`rename_doc`** - ÈáçÂëΩÂêçÊñáÊ°£Ôºå‰øùÊåÅÂÜÖÂÆπ‰∏çÂèò
- **`rename_doc_by_id`** - Ê†πÊçÆÊñáÊ°£IDÈáçÂëΩÂêçÔºåÁ≤æÁ°ÆÊìç‰Ωú
- **`remove_doc`** - Âà†Èô§ÊñáÊ°£ÔºåÊ∏ÖÁêÜÊñá‰ª∂Á≥ªÁªü
- **`remove_doc_by_id`** - Ê†πÊçÆÊñáÊ°£IDÂà†Èô§ÔºåÁ≤æÁ°ÆÊìç‰Ωú
- **`move_docs`** - ÁßªÂä®ÊñáÊ°£Âà∞ÂÖ∂‰ªñ‰ΩçÁΩÆÊàñÁ¨îËÆ∞Êú¨
- **`move_docs_by_id`** - Ê†πÊçÆÊñáÊ°£IDÁßªÂä®ÔºåÁ≤æÁ°ÆÊìç‰Ωú
- **`get_hpath_by_path`** - Ê†πÊçÆË∑ØÂæÑËé∑Âèñ‰∫∫Á±ªÂèØËØªË∑ØÂæÑ
- **`get_hpath_by_id`** - Ê†πÊçÆIDËé∑Âèñ‰∫∫Á±ªÂèØËØªË∑ØÂæÑ
- **`get_path_by_id`** - Ê†πÊçÆIDËé∑ÂèñÂ≠òÂÇ®Ë∑ØÂæÑ
- **`get_ids_by_hpath`** - Ê†πÊçÆ‰∫∫Á±ªÂèØËØªË∑ØÂæÑËé∑ÂèñIDs

#### üß© ÂùóÊìç‰Ωú (11‰∏™Êé•Âè£)
ÂùóÊòØÊÄùÊ∫êÁ¨îËÆ∞ÁöÑÊúÄÂ∞èÂÜÖÂÆπÂçï‰ΩçÔºåÊîØÊåÅÁÅµÊ¥ªÁöÑÁºñËæë„ÄÅÈáçÁªÑÂíåÂºïÁî®„ÄÇ

- **`insert_block`** - ÊèíÂÖ•ÂùóÔºåÊîØÊåÅÊåáÂÆö‰ΩçÁΩÆÂíåÊï∞ÊçÆÁ±ªÂûã
- **`prepend_block`** - ÊèíÂÖ•ÂâçÁΩÆÂ≠êÂùóÔºåÂú®Áà∂ÂùóÂºÄÂ§¥Ê∑ªÂä†ÂÜÖÂÆπ
- **`append_block`** - ÊèíÂÖ•ÂêéÁΩÆÂ≠êÂùóÔºåÂú®Áà∂ÂùóÊú´Â∞æÊ∑ªÂä†ÂÜÖÂÆπ
- **`update_block`** - Êõ¥Êñ∞ÂùóÂÜÖÂÆπÔºåÊîØÊåÅMarkdownÂíåDOMÊ†ºÂºè
- **`delete_block`** - Âà†Èô§ÂùóÔºåÊ∏ÖÁêÜÁõ∏ÂÖ≥ÂºïÁî®
- **`move_block`** - ÁßªÂä®ÂùóÂà∞Êñ∞‰ΩçÁΩÆÔºåÊîØÊåÅÂ±ÇÁ∫ßË∞ÉÊï¥
- **`get_block_kramdown`** - Ëé∑ÂèñÂùókramdownÊ∫êÁ†ÅÔºåÁî®‰∫éÂØºÂá∫
- **`get_child_blocks`** - Ëé∑ÂèñÂ≠êÂùóÂàóË°®ÔºåÈÅçÂéÜÂùóÁªìÊûÑ
- **`fold_block`** - ÊäòÂè†ÂùóÔºåÈöêËóèÂ≠êÂÜÖÂÆπ
- **`unfold_block`** - Â±ïÂºÄÂùóÔºåÊòæÁ§∫Â≠êÂÜÖÂÆπ
- **`transfer_block_ref`** - ËΩ¨ÁßªÂùóÂºïÁî®ÔºåÁª¥Êä§ÂºïÁî®ÂÖ≥Á≥ª

#### üè∑Ô∏è Â±ûÊÄßÊìç‰Ωú (2‰∏™Êé•Âè£)
ÂùóÂ±ûÊÄßÁî®‰∫éÂ≠òÂÇ®ÂÖÉÊï∞ÊçÆÂíåËá™ÂÆö‰πâ‰ø°ÊÅØÔºåÊîØÊåÅÈîÆÂÄºÂØπÂ≠òÂÇ®„ÄÇ

- **`set_block_attrs`** - ËÆæÁΩÆÂùóÂ±ûÊÄßÔºåÊîØÊåÅËá™ÂÆö‰πâÈîÆÂÄºÂØπ
- **`get_block_attrs`** - Ëé∑ÂèñÂùóÂ±ûÊÄßÔºåËØªÂèñÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ

#### üîç ÊêúÁ¥¢ÂíåÊü•ËØ¢ (2‰∏™Êé•Âè£)
ÈÄöËøáSQLÊü•ËØ¢Ëé∑ÂèñÊÄùÊ∫êÁ¨îËÆ∞‰∏≠ÁöÑÊï∞ÊçÆÔºåÊîØÊåÅÂ§çÊùÇÊü•ËØ¢Êù°‰ª∂„ÄÇ

- **`sql_query`** - ÊâßË°åSQLÊü•ËØ¢ÔºåÊîØÊåÅÊâÄÊúâSQLiteËØ≠Ê≥ï
- **`flush_transaction`** - Êèê‰∫§‰∫ãÂä°ÔºåÁ°Æ‰øùÊï∞ÊçÆÊåÅ‰πÖÂåñ

#### üìÅ Êñá‰ª∂Êìç‰Ωú (5‰∏™Êé•Âè£)
ÁÆ°ÁêÜÊÄùÊ∫êÁ¨îËÆ∞Â∑•‰ΩúÁ©∫Èó¥‰∏≠ÁöÑÊñá‰ª∂ÂíåÁõÆÂΩïÔºåÊîØÊåÅËµÑÊ∫êÁÆ°ÁêÜ„ÄÇ

- **`get_file`** - Ëé∑ÂèñÊñá‰ª∂ÂÜÖÂÆπÔºåËØªÂèñÊñá‰ª∂Êï∞ÊçÆ
- **`remove_file`** - Âà†Èô§Êñá‰ª∂ÔºåÊ∏ÖÁêÜÂ≠òÂÇ®Á©∫Èó¥
- **`rename_file`** - ÈáçÂëΩÂêçÊñá‰ª∂ÔºåÊõ¥Êñ∞Êñá‰ª∂Ë∑ØÂæÑ
- **`read_dir`** - ÂàóÂá∫ÁõÆÂΩïÂÜÖÂÆπÔºåÊµèËßàÊñá‰ª∂ÁªìÊûÑ
- **`put_file`** - ÂÜôÂÖ•Êñá‰ª∂ÔºåÂàõÂª∫ÊàñÊõ¥Êñ∞Êñá‰ª∂ÂÜÖÂÆπ

#### üì§ ÂØºÂá∫ÂäüËÉΩ (2‰∏™Êé•Âè£)
Â∞ÜÊÄùÊ∫êÁ¨îËÆ∞ÂÜÖÂÆπÂØºÂá∫‰∏∫ÂêÑÁßçÊ†ºÂºèÔºåÊîØÊåÅÂ§á‰ªΩÂíåÂàÜ‰∫´„ÄÇ

- **`export_md_content`** - ÂØºÂá∫MarkdownÊñáÊú¨Ôºå‰øùÊåÅÊ†ºÂºè
- **`export_resources`** - ÂØºÂá∫Êñá‰ª∂‰∏éÁõÆÂΩïÔºåÂåÖÂê´ËµÑÊ∫êÊñá‰ª∂

#### üì¢ ÈÄöÁü•ÂäüËÉΩ (2‰∏™Êé•Âè£)
ÂêëÁî®Êà∑Êé®ÈÄÅÊ∂àÊÅØÂíåÈîôËØØÊèêÁ§∫ÔºåÊèê‰æõÊìç‰ΩúÂèçÈ¶à„ÄÇ

- **`push_msg`** - Êé®ÈÄÅÊ∂àÊÅØÔºåÊòæÁ§∫ÊàêÂäüÊèêÁ§∫
- **`push_err_msg`** - Êé®ÈÄÅÈîôËØØÊ∂àÊÅØÔºåÊòæÁ§∫ÈîôËØØ‰ø°ÊÅØ

#### üíª Á≥ªÁªü‰ø°ÊÅØ (5‰∏™Êé•Âè£)
Ëé∑ÂèñÊÄùÊ∫êÁ¨îËÆ∞Á≥ªÁªüÁä∂ÊÄÅÂíåËøêË°å‰ø°ÊÅØÔºåÁõëÊéßÁ≥ªÁªüÂÅ•Â∫∑„ÄÇ

- **`get_version`** - Ëé∑ÂèñÊÄùÊ∫êÁ¨îËÆ∞ÁâàÊú¨‰ø°ÊÅØ
- **`get_current_time`** - Ëé∑ÂèñÁ≥ªÁªüÂΩìÂâçÊó∂Èó¥
- **`get_boot_progress`** - Ëé∑ÂèñÂêØÂä®ËøõÂ∫¶ÔºåÁõëÊéßÂêØÂä®Áä∂ÊÄÅ
- **`check_siyuan_status`** - Ê£ÄÊü•ÊÄùÊ∫êÁ¨îËÆ∞Áä∂ÊÄÅÂíåAPIÂèØÁî®ÊÄß
- **`get_workspace_info`** - Ëé∑ÂèñÂ∑•‰ΩúÁ©∫Èó¥ÂíåËøûÊé•‰ø°ÊÅØ

#### üé® Ê®°ÊùøÂäüËÉΩ (2‰∏™Êé•Âè£)
‰ΩøÁî®Ê®°ÊùøÁ≥ªÁªüÂàõÂª∫Âä®ÊÄÅÂÜÖÂÆπÔºåÊîØÊåÅÂèòÈáèÊõøÊç¢„ÄÇ

- **`render_template`** - Ê∏≤ÊüìÊ®°ÊùøÊñá‰ª∂ÔºåÊîØÊåÅÂ§ñÈÉ®Ê®°Êùø
- **`render_sprig`** - Ê∏≤ÊüìSprigÊ®°ÊùøÔºåÊîØÊåÅÂÜÖËÅîÊ®°ÊùøËØ≠Ê≥ï

#### üîÑ ËΩ¨Êç¢ÂäüËÉΩ (1‰∏™Êé•Âè£)
‰ΩøÁî®PandocËøõË°åÊñáÊ°£Ê†ºÂºèËΩ¨Êç¢ÔºåÊîØÊåÅÂ§öÁßçËæìÂá∫Ê†ºÂºè„ÄÇ

- **`pandoc_convert`** - PandocËΩ¨Êç¢ÔºåÊîØÊåÅÂ§öÁßçÊñáÊ°£Ê†ºÂºè

#### üìé ËµÑÊ∫êÊñá‰ª∂ (1‰∏™Êé•Âè£)
ÁÆ°ÁêÜÊÄùÊ∫êÁ¨îËÆ∞‰∏≠ÁöÑËµÑÊ∫êÊñá‰ª∂ÔºåÊîØÊåÅÊâπÈáè‰∏ä‰º†„ÄÇ

- **`upload_asset`** - ‰∏ä‰º†ËµÑÊ∫êÊñá‰ª∂ÔºåÊîØÊåÅÊâπÈáèÊìç‰Ωú

### üîß Ê†∏ÂøÉÁâπÊÄß

#### üöÄ È´òÊÄßËÉΩ
- **ÂºÇÊ≠•Â§ÑÁêÜ**: ÊâÄÊúâAPIË∞ÉÁî®ÈááÁî®ÂºÇÊ≠•Â§ÑÁêÜÔºåÊèêÈ´òÂìçÂ∫îÈÄüÂ∫¶
- **ÊâπÈáèÊìç‰Ωú**: ÊîØÊåÅÊâπÈáèÊñáÊ°£ÁßªÂä®ÂíåÂùóÊìç‰ΩúÔºåÊèêÂçáÊïàÁéá
- **‰∫ãÂä°ÁÆ°ÁêÜ**: ÂÜÖÁΩÆ‰∫ãÂä°Êú∫Âà∂ÔºåÁ°Æ‰øùÊï∞ÊçÆ‰∏ÄËá¥ÊÄß

#### üõ°Ô∏è ÂÆâÂÖ®ÂèØÈù†
- **Ë∫´‰ªΩÈ™åËØÅ**: ÊîØÊåÅAPI‰ª§ÁâåËÆ§ËØÅÔºå‰øùÊä§Êï∞ÊçÆÂÆâÂÖ®
- **ÈîôËØØÂ§ÑÁêÜ**: ÂÆåÂñÑÁöÑÈîôËØØÂ§ÑÁêÜÊú∫Âà∂ÔºåÊèê‰æõËØ¶ÁªÜÈîôËØØ‰ø°ÊÅØ
- **ÂèÇÊï∞È™åËØÅ**: ‰∏•Ê†ºÁöÑÂèÇÊï∞È™åËØÅÔºåÈò≤Ê≠¢Êó†ÊïàÊìç‰Ωú

#### üîå Êòì‰∫éÈõÜÊàê
- **MCPÂçèËÆÆ**: Âü∫‰∫éModel Context ProtocolÔºåÊòì‰∫é‰∏éAIÂ∑•ÂÖ∑ÈõÜÊàê
- **Ê†áÂáÜÊé•Âè£**: ÈÅµÂæ™ÊÄùÊ∫êÁ¨îËÆ∞ÂÆòÊñπAPIËßÑËåÉ
- **Â§öËØ≠Ë®ÄÊîØÊåÅ**: ÊîØÊåÅ‰∏≠Ëã±ÊñáÊñáÊ°£ÂíåÈîôËØØ‰ø°ÊÅØ

#### üìä Êï∞ÊçÆÁÆ°ÁêÜ
- **ÂÆåÊï¥CRUD**: ÊîØÊåÅÂàõÂª∫„ÄÅËØªÂèñ„ÄÅÊõ¥Êñ∞„ÄÅÂà†Èô§ÊâÄÊúâÊï∞ÊçÆÁ±ªÂûã
- **Â±ÇÁ∫ßÁªìÊûÑ**: ÊîØÊåÅÊñáÊ°£ÂíåÂùóÁöÑÂ±ÇÁ∫ßÁªÑÁªá
- **ÂºïÁî®Á≥ªÁªü**: ÊîØÊåÅÂùóÂºïÁî®ÂíåËΩ¨ÁßªÔºåÁª¥Êä§Êï∞ÊçÆÂÖ≥Á≥ª

#### üéØ ÂºÄÂèëÂèãÂ•Ω
- **ËØ¶ÁªÜÊó•Âøó**: Êèê‰æõËØ¶ÁªÜÁöÑAPIË∞ÉÁî®Êó•ÂøóÔºå‰æø‰∫éË∞ÉËØï
- **Áä∂ÊÄÅÊ£ÄÊü•**: ÂÜÖÁΩÆËøûÊé•Áä∂ÊÄÅÊ£ÄÊü•ÔºåÂø´ÈÄüËØäÊñ≠ÈóÆÈ¢ò
- **Á§∫‰æã‰∏∞ÂØå**: Êèê‰æõÂÆåÊï¥ÁöÑ‰ΩøÁî®Á§∫‰æãÂíåÊúÄ‰Ω≥ÂÆûË∑µ

### üìä Êé•Âè£ÁªüËÆ°

- **ÊÄªÊé•Âè£Êï∞**: 49‰∏™
- **ÂäüËÉΩÊ®°Âùó**: 12‰∏™
- **ÊîØÊåÅÁöÑÊìç‰Ωú**: ÂÆåÊï¥ÁöÑÊÄùÊ∫êÁ¨îËÆ∞APIÂäüËÉΩ
- **Ë¶ÜÁõñËåÉÂõ¥**: 100%ÊÄùÊ∫êÁ¨îËÆ∞ÂÆòÊñπAPIÔºàÈô§ÁΩëÁªúÊé•Âè£Â§ñÔºâ

### üìö ‰ΩøÁî®Á§∫‰æã

#### Âü∫Á°ÄÊìç‰ΩúÁ§∫‰æã

**ÂàóÂá∫ÊâÄÊúâÁ¨îËÆ∞Êú¨**
```json
{
  "name": "list_notebooks",
  "arguments": {}
}
```

**ÂàõÂª∫Êñ∞ÊñáÊ°£**
```json
{
  "name": "create_doc",
  "arguments": {
    "notebook": "20241009135857-599ipbh",
    "path": "/daily/2025-01-15",
    "markdown": "# ‰ªäÊó•ÊÄªÁªì\n\n‰ªäÂ§©ÂÆåÊàê‰∫Ü‰ª•‰∏ãÂ∑•‰ΩúÔºö\n- È°πÁõÆÂºÄÂèë\n- ÊñáÊ°£ÁºñÂÜô"
  }
}
```

**ÊâßË°å SQL Êü•ËØ¢**
```json
{
  "name": "sql_query",
  "arguments": {
    "sql": "SELECT * FROM blocks WHERE type = 'd' ORDER BY created DESC LIMIT 5"
  }
}
```

**ÊèíÂÖ•Âùó**
```json
{
  "name": "insert_block",
  "arguments": {
    "data": "ËøôÊòØ‰∏Ä‰∏™Êñ∞ÁöÑÂùóÂÜÖÂÆπ",
    "dataType": "markdown",
    "parentID": "20250803150424-tu1cl78"
  }
}
```

**ËÆæÁΩÆÂùóÂ±ûÊÄß**
```json
{
  "name": "set_block_attrs",
  "arguments": {
    "id": "20250803150424-tu1cl78",
    "attrs": {
      "custom-status": "active",
      "custom-tag": "important"
    }
  }
}
```

#### È´òÁ∫ßÊìç‰ΩúÁ§∫‰æã

**Ê£ÄÊü•ÊÄùÊ∫êÁ¨îËÆ∞Áä∂ÊÄÅ**
```json
{
  "name": "check_siyuan_status",
  "arguments": {}
}
```

**Ëé∑ÂèñÂ∑•‰ΩúÁ©∫Èó¥‰ø°ÊÅØ**
```json
{
  "name": "get_workspace_info",
  "arguments": {}
}
```

**ÊâπÈáèÁßªÂä®ÊñáÊ°£**
```json
{
  "name": "move_docs",
  "arguments": {
    "fromPaths": ["/daily/2025-01-14", "/daily/2025-01-13"],
    "toNotebook": "20241009135857-599ipbh",
    "toPath": "/archive/2025-01"
  }
}
```

**ÂØºÂá∫ÊñáÊ°£ÂÜÖÂÆπ**
```json
{
  "name": "export_md_content",
  "arguments": {
    "id": "20250115123456-abcdef"
  }
}
```

**‰ΩøÁî®Ê®°ÊùøÊ∏≤Êüì**
```json
{
  "name": "render_sprig",
  "arguments": {
    "template": "Hello {{.name}}! Today is {{.date}}. Your tasks: {{range .tasks}}- {{.}}\n{{end}}"
  }
}
```

**‰∏ä‰º†ËµÑÊ∫êÊñá‰ª∂**
```json
{
  "name": "upload_asset",
  "arguments": {
    "assetsDirPath": "/assets/images",
    "files": ["screenshot.png", "diagram.svg", "document.pdf"]
  }
}
```

#### Â∏∏Áî®SQLÊü•ËØ¢Á§∫‰æã

**Ëé∑ÂèñÊúÄËøëÂàõÂª∫ÁöÑÊñáÊ°£**
```sql
SELECT * FROM blocks WHERE type = 'd' ORDER BY created DESC LIMIT 10
```

**Êü•ÊâæÂåÖÂê´ÁâπÂÆöÊ†áÁ≠æÁöÑÂùó**
```sql
SELECT * FROM blocks WHERE content LIKE '%#ÈáçË¶Å%' OR content LIKE '%#urgent%'
```

**ÁªüËÆ°ÂêÑÁ±ªÂûãÂùóÁöÑÊï∞Èáè**
```sql
SELECT type, COUNT(*) as count FROM blocks GROUP BY type
```

**Êü•ÊâæÁ©∫ÂÜÖÂÆπÁöÑÂùó**
```sql
SELECT * FROM blocks WHERE content = '' OR content IS NULL
```

**Ëé∑ÂèñÁâπÂÆöÊó∂Èó¥ËåÉÂõ¥ÂÜÖÁöÑÂÜÖÂÆπ**
```sql
SELECT * FROM blocks WHERE created >= '2025-01-01' AND created <= '2025-01-31'
```

### üìö ÂºÄÂèëËµÑÊ∫ê

#### Áõ∏ÂÖ≥ÈìæÊé•
- [ÊÄùÊ∫êÁ¨îËÆ∞ÂÆòÊñπÊñáÊ°£](https://b3log.org/siyuan/)
- [ÊÄùÊ∫êÁ¨îËÆ∞APIÊñáÊ°£](https://github.com/siyuan-note/siyuan/blob/master/API_zh_CN.md)
- [Model Context Protocol](https://modelcontextprotocol.io/)

#### Á§æÂå∫ÊîØÊåÅ
- [ÊÄùÊ∫êÁ¨îËÆ∞Á§æÂå∫](https://b3log.org/siyuan/)
- [GitHub Issues](https://github.com/xgq18237/siyuan_mcp_server/issues)

#### ÊäÄÊúØÊ†à
- **ËØ≠Ë®Ä**: TypeScript/JavaScript
- **ÂçèËÆÆ**: Model Context Protocol (MCP)
- **Ê°ÜÊû∂**: @modelcontextprotocol/sdk
- **ÈÉ®ÁΩ≤**: Docker, Node.js
- **Êï∞ÊçÆÂ∫ì**: SQLite (ÈÄöËøáÊÄùÊ∫êÁ¨îËÆ∞)

#### ÂºÄÂèëÂ∑•ÂÖ∑
- **ÁºñËæëÂô®**: VS Code, Cursor
- **ÊûÑÂª∫Â∑•ÂÖ∑**: TypeScript Compiler
- **ÂåÖÁÆ°ÁêÜ**: npm
- **ÂÆπÂô®Âåñ**: Docker, Docker Compose



### üõ†Ô∏è ÂºÄÂèë

#### È°πÁõÆÁªìÊûÑ
```
siyuan-mcp/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ index.ts          # ‰∏ªÊúçÂä°Âô®‰ª£Á†Å
‚îú‚îÄ‚îÄ dist/                 # ÁºñËØëËæìÂá∫
‚îú‚îÄ‚îÄ package.json          # È°πÁõÆÈÖçÁΩÆ
‚îú‚îÄ‚îÄ tsconfig.json         # TypeScript ÈÖçÁΩÆ
‚îú‚îÄ‚îÄ docker-compose.yml    # Docker Compose ÈÖçÁΩÆ
‚îú‚îÄ‚îÄ Dockerfile           # Docker ÊûÑÂª∫Êñá‰ª∂
‚îú‚îÄ‚îÄ env.example          # ÁéØÂ¢ÉÂèòÈáèÊ®°Êùø
‚îî‚îÄ‚îÄ README.md            # È°πÁõÆÊñáÊ°£
```

#### ÂºÄÂèëÂëΩ‰ª§
```bash
# ÂÆâË£Ö‰æùËµñ
npm install

# ÊûÑÂª∫È°πÁõÆ
npm run build

# ÂºÄÂèëÊ®°Âºè
npm run dev

# ÂêØÂä®ÊúçÂä°Âô®
npm start

# ÊµãËØï Docker ÈÉ®ÁΩ≤
npm test

# Ê∏ÖÁêÜÂπ∂ÈáçÊñ∞ÊûÑÂª∫
npm run rebuild
```

### üîÑ Êõ¥Êñ∞Êó•Âøó

#### v1.0.0 (2025-01-15)
- ‚úÖ ÂÆåÊàê49‰∏™APIÊé•Âè£ÁöÑÂÆûÁé∞
- ‚úÖ ‰øÆÂ§çÊâÄÊúâ‰∏çÂ≠òÂú®ÁöÑÊé•Âè£Ë∞ÉÁî®
- ‚úÖ Ê∑ªÂä†Áº∫Â§±ÁöÑÊé•Âè£ÂäüËÉΩ
- ‚úÖ ÂÆåÂñÑÈîôËØØÂ§ÑÁêÜÂíåÂèÇÊï∞È™åËØÅ
- ‚úÖ ‰ºòÂåñ‰ª£Á†ÅÁªìÊûÑÂíåÊñáÊ°£
- ‚úÖ ÊîØÊåÅÂÆåÊï¥ÁöÑÊÄùÊ∫êÁ¨îËÆ∞APIÂäüËÉΩ

#### ‰∏ªË¶ÅÊîπËøõ
1. **Êé•Âè£ÂÆåÊï¥ÊÄß**: ÂÆûÁé∞‰∫ÜÊÄùÊ∫êÁ¨îËÆ∞ÂÆòÊñπAPIÊñáÊ°£‰∏≠ÁöÑÊâÄÊúâÊé•Âè£ÔºàÈô§ÁΩëÁªúÊé•Âè£Â§ñÔºâ
2. **ÈîôËØØÂ§ÑÁêÜ**: ÊîπËøõ‰∫ÜÈîôËØØÂ§ÑÁêÜÂíåÂèÇÊï∞È™åËØÅ
3. **ÊñáÊ°£Êõ¥Êñ∞**: Êõ¥Êñ∞‰∫ÜREADMEÊñáÊ°£‰ª•ÂèçÊò†ÂΩìÂâçÂäüËÉΩ
4. **ÊµãËØïË¶ÜÁõñ**: ÂÆåÊàê‰∫ÜÊâÄÊúâÊé•Âè£ÁöÑÊµãËØïÂíåÈ™åËØÅ

### üìÑ ËÆ∏ÂèØËØÅ

MIT License

---

## ËØ¶ÁªÜ‰ΩøÁî®ÊåáÂçó

### üîç Êé•Âè£ÂàÜÁ±ªËØ¶Ëß£

#### 1. Á¨îËÆ∞Êú¨ÁÆ°ÁêÜ
Á¨îËÆ∞Êú¨ÊòØÊÄùÊ∫êÁ¨îËÆ∞ÁöÑÂü∫Êú¨ÁªÑÁªáÂçï‰ΩçÔºåÊØè‰∏™Á¨îËÆ∞Êú¨ÂåÖÂê´Â§ö‰∏™ÊñáÊ°£„ÄÇ

**Â∏∏Áî®Êìç‰Ωú**Ôºö
- `list_notebooks`: Ëé∑ÂèñÊâÄÊúâÁ¨îËÆ∞Êú¨ÂàóË°®ÔºåÁî®‰∫é‰∫ÜËß£ÂΩìÂâçÂèØÁî®ÁöÑÁ¨îËÆ∞Êú¨
- `create_notebook`: ÂàõÂª∫Êñ∞Á¨îËÆ∞Êú¨Ôºå‰∏∫Êñ∞ÁöÑÁü•ËØÜÈ¢ÜÂüüÂÅöÂáÜÂ§á
- `open_notebook`: ÊâìÂºÄÊåáÂÆöÁ¨îËÆ∞Êú¨ÔºåÂºÄÂßãÂú®ËØ•Á¨îËÆ∞Êú¨‰∏≠Â∑•‰Ωú

#### 2. ÊñáÊ°£ÁÆ°ÁêÜ
ÊñáÊ°£ÊòØÁ¨îËÆ∞Êú¨‰∏≠ÁöÑÂÖ∑‰ΩìÂÜÖÂÆπÂçïÂÖÉÔºåÊîØÊåÅÂ±ÇÁ∫ßÁªìÊûÑ„ÄÇ

**Â∏∏Áî®Êìç‰Ωú**Ôºö
- `create_doc`: ÂàõÂª∫Êñ∞ÊñáÊ°£ÔºåÊîØÊåÅÊåáÂÆöË∑ØÂæÑÂíåMarkdownÂÜÖÂÆπ
- `rename_doc`: ÈáçÂëΩÂêçÊñáÊ°£Ôºå‰øùÊåÅÂÜÖÂÆπ‰∏çÂèò
- `move_docs`: ÁßªÂä®ÊñáÊ°£Âà∞ÂÖ∂‰ªñ‰ΩçÁΩÆÊàñÁ¨îËÆ∞Êú¨

#### 3. ÂùóÊìç‰Ωú
ÂùóÊòØÊÄùÊ∫êÁ¨îËÆ∞ÁöÑÊúÄÂ∞èÂÜÖÂÆπÂçï‰ΩçÔºåÊîØÊåÅÁÅµÊ¥ªÁöÑÁºñËæëÂíåÈáçÁªÑ„ÄÇ

**Â∏∏Áî®Êìç‰Ωú**Ôºö
- `insert_block`: Âú®ÊåáÂÆö‰ΩçÁΩÆÊèíÂÖ•Êñ∞Âùó
- `append_block`: Âú®Áà∂ÂùóÊú´Â∞æÊ∑ªÂä†Â≠êÂùó
- `update_block`: Êõ¥Êñ∞Áé∞ÊúâÂùóÁöÑÂÜÖÂÆπ
- `move_block`: ÁßªÂä®ÂùóÂà∞Êñ∞‰ΩçÁΩÆ

#### 4. ÊêúÁ¥¢ÂíåÊü•ËØ¢
ÈÄöËøáSQLÊü•ËØ¢Ëé∑ÂèñÊÄùÊ∫êÁ¨îËÆ∞‰∏≠ÁöÑÊï∞ÊçÆ„ÄÇ

**Â∏∏Áî®Êìç‰Ωú**Ôºö
- `sql_query`: ÊâßË°åËá™ÂÆö‰πâSQLÊü•ËØ¢
- Â∏∏Áî®Êü•ËØ¢Á§∫‰æãÔºö
  - Ëé∑ÂèñÊúÄËøëÂàõÂª∫ÁöÑÊñáÊ°£Ôºö`SELECT * FROM blocks WHERE type = 'd' ORDER BY created DESC LIMIT 10`
  - Ëé∑ÂèñÊâÄÊúâÊ†áÁ≠æÔºö`SELECT * FROM blocks WHERE content LIKE '%#%'`

### üõ†Ô∏è ÊïÖÈöúÊéíÈô§

#### Â∏∏ËßÅÈîôËØØÂèäËß£ÂÜ≥ÊñπÊ°à

**1. ËøûÊé•Â§±Ë¥•**
```
Error: Failed to call SiYuan API: HTTP 401: Unauthorized
```
**Ëß£ÂÜ≥ÊñπÊ°à**Ôºö
- Ê£ÄÊü•API‰ª§ÁâåÊòØÂê¶Ê≠£Á°Æ
- Á°ÆËÆ§ÊÄùÊ∫êÁ¨îËÆ∞Ê≠£Âú®ËøêË°å
- È™åËØÅÁΩëÁªúËøûÊé•

**2. Á©∫ÂìçÂ∫îÈîôËØØ**
```
Error: Empty response from server
```
**Ëß£ÂÜ≥ÊñπÊ°à**Ôºö
- Á°Æ‰øùÊÄùÊ∫êÁ¨îËÆ∞APIÊúçÂä°Â∑≤ÂêØÁî®
- Ê£ÄÊü•ÊÄùÊ∫êÁ¨îËÆ∞ËÆæÁΩÆ‰∏≠ÁöÑAPIÈÄâÈ°π
- ÈáçÂêØÊÄùÊ∫êÁ¨îËÆ∞

**3. Á¨îËÆ∞Êú¨‰∏çÂ≠òÂú®**
```
Error: Á¨îËÆ∞Êú¨‰∏çÂ≠òÂú®
```
**Ëß£ÂÜ≥ÊñπÊ°à**Ôºö
- ‰ΩøÁî®`list_notebooks`Êü•ÁúãÂèØÁî®Á¨îËÆ∞Êú¨
- Á°ÆËÆ§Á¨îËÆ∞Êú¨IDÊ≠£Á°Æ
- ÂÖàÂàõÂª∫Á¨îËÆ∞Êú¨ÂÜçÊìç‰Ωú

**4. ÊñáÊ°£Ë∑ØÂæÑÈîôËØØ**
```
Error: ÊñáÊ°£Ë∑ØÂæÑ‰∏çÂ≠òÂú®
```
**Ëß£ÂÜ≥ÊñπÊ°à**Ôºö
- ‰ΩøÁî®`get_hpath_by_path`È™åËØÅË∑ØÂæÑ
- Á°Æ‰øùË∑ØÂæÑÊ†ºÂºèÊ≠£Á°ÆÔºàÂ¶ÇÔºö`/daily/2025-01-15`Ôºâ
- ÂÖàÂàõÂª∫Áà∂Á∫ßÁõÆÂΩï

### üìù ÊúÄ‰Ω≥ÂÆûË∑µ

#### 1. Â∑•‰ΩúÊµÅÁ®ãÂª∫ËÆÆ
1. **ÂàùÂßãÂåñ**Ôºö‰ΩøÁî®`check_siyuan_status`Ê£ÄÊü•ËøûÊé•Áä∂ÊÄÅ
2. **Ëé∑Âèñ‰ø°ÊÅØ**Ôºö‰ΩøÁî®`list_notebooks`Ëé∑ÂèñÂèØÁî®Á¨îËÆ∞Êú¨
3. **ÂàõÂª∫ÂÜÖÂÆπ**Ôºö‰ΩøÁî®`create_doc`ÂàõÂª∫Êñ∞ÊñáÊ°£
4. **ÁºñËæëÂÜÖÂÆπ**Ôºö‰ΩøÁî®ÂùóÊìç‰ΩúAPIËøõË°åÂÜÖÂÆπÁºñËæë
5. **ÁªÑÁªáÂÜÖÂÆπ**Ôºö‰ΩøÁî®ÁßªÂä®ÂíåÈáçÂëΩÂêçÂäüËÉΩÊï¥ÁêÜÂÜÖÂÆπ

#### 2. ÈîôËØØÂ§ÑÁêÜ
- ÂßãÁªàÊ£ÄÊü•APIÂìçÂ∫îÁöÑ`code`Â≠óÊÆµ
- ‰ΩøÁî®`push_msg`Âíå`push_err_msg`Êèê‰æõÁî®Êà∑ÂèçÈ¶à
- Âú®ÊâπÈáèÊìç‰ΩúÂâçÂÖàÊµãËØïÂçï‰∏™Êìç‰Ωú

#### 3. ÊÄßËÉΩ‰ºòÂåñ
- ‰ΩøÁî®`flush_transaction`Êèê‰∫§ÊâπÈáèÊìç‰Ωú
- ÂêàÁêÜ‰ΩøÁî®SQLÊü•ËØ¢ÔºåÈÅøÂÖçÊü•ËØ¢Â§ßÈáèÊï∞ÊçÆ
- ÂèäÊó∂Ê∏ÖÁêÜ‰∏çÈúÄË¶ÅÁöÑÂùóÂíåÊñáÊ°£

### üîß È´òÁ∫ßÂäüËÉΩ

#### 1. Ê®°ÊùøÁ≥ªÁªü
‰ΩøÁî®`render_template`Âíå`render_sprig`ÂàõÂª∫Âä®ÊÄÅÂÜÖÂÆπÔºö
```json
{
  "name": "render_sprig",
  "arguments": {
    "template": "Hello {{.name}}! Today is {{.date}}."
  }
}
```

#### 2. Êñá‰ª∂ÁÆ°ÁêÜ
‰ΩøÁî®Êñá‰ª∂Êìç‰ΩúAPIÁÆ°ÁêÜÈôÑ‰ª∂ÂíåËµÑÊ∫êÔºö
```json
{
  "name": "upload_asset",
  "arguments": {
    "assetsDirPath": "/assets",
    "files": ["image1.jpg", "document.pdf"]
  }
}
```

#### 3. Êï∞ÊçÆÂØºÂá∫
‰ΩøÁî®ÂØºÂá∫ÂäüËÉΩÂ§á‰ªΩÂíåÂàÜ‰∫´ÂÜÖÂÆπÔºö
```json
{
  "name": "export_md_content",
  "arguments": {
    "id": "20250115123456-abcdef"
  }
}
```

#### 4. ÊâπÈáèÊìç‰Ωú
ÊîØÊåÅÊâπÈáèÊñáÊ°£ÂíåÂùóÊìç‰ΩúÔºåÊèêÈ´òÊïàÁéáÔºö
```json
{
  "name": "move_docs",
  "arguments": {
    "fromPaths": ["/doc1", "/doc2", "/doc3"],
    "toNotebook": "notebook-id",
    "toPath": "/archive"
  }
}
```

#### 5. Áä∂ÊÄÅÁõëÊéß
ÂÆûÊó∂ÁõëÊéßÊÄùÊ∫êÁ¨îËÆ∞Á≥ªÁªüÁä∂ÊÄÅÔºö
```json
{
  "name": "check_siyuan_status",
  "arguments": {}
}
```

---

**[‚¨Ü ËøîÂõûÈ°∂ÈÉ®](#ÊÄùÊ∫êÁ¨îËÆ∞-mcp-ÊúçÂä°Âô®--siyuan-mcp-server)**