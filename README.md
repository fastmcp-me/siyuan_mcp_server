# ÊÄùÊ∫êÁ¨îËÆ∞ MCP ÊúçÂä°Âô® / SiYuan MCP Server

<div align="center">

[English](#english-version) | [‰∏≠Êñá](#‰∏≠ÊñáÁâàÊú¨)

</div>

---

## English Version

A Model Context Protocol (MCP) server for SiYuan Note, providing complete SiYuan API functionality.

### üöÄ Quick Start

#### Using npx (Recommended)
```bash
# Run directly
npx -y siyuan-mcp@latest

# Set environment variables
SIYUAN_HOST=127.0.0.1 SIYUAN_PORT=6806 SIYUAN_TOKEN=your-token npx -y siyuan-mcp@latest
```

#### Using Docker
```bash
# Pull image
docker pull zhizhiqq/siyuan-mcp:latest

# Run container
docker run -d \
  -e SIYUAN_HOST=127.0.0.1 \
  -e SIYUAN_PORT=6806 \
  -e SIYUAN_TOKEN=your-token \
  --name siyuan-mcp-server \
  zhizhiqq/siyuan-mcp:latest
```

#### Configure MCP Client

##### Cursor Configuration
1. Open Cursor settings (Ctrl/Cmd + ,)
2. Search for "MCP" or "Model Context Protocol"
3. Click "Add Server" or "Ê∑ªÂä†ÊúçÂä°Âô®"
4. Configure server information:
```json
{
  "mcpServers": {
    "siyuan-mcp": {
      "command": "npx",
      "args": ["-y", "siyuan-mcp@latest"],
      "env": {
        "SIYUAN_HOST": "127.0.0.1",
        "SIYUAN_PORT": "6806",
        "SIYUAN_TOKEN": "your-api-token-here"
      }
    }
  }
}
```

##### Claude Desktop Configuration
1. Open Claude Desktop settings
2. Go to "Model Context Protocol" settings
3. Add new MCP server:
```json
{
  "mcpServers": {
    "siyuan-mcp": {
      "command": "npx",
      "args": ["-y", "siyuan-mcp@latest"],
      "env": {
        "SIYUAN_HOST": "127.0.0.1",
        "SIYUAN_PORT": "6806",
        "SIYUAN_TOKEN": "your-api-token-here"
      }
    }
  }
}
```

##### Docker Configuration
If you use Docker to run the service, you can configure the client to connect to the Docker container:

**Cursor Docker Configuration**
```json
{
  "mcpServers": {
    "siyuan-mcp": {
      "command": "docker",
      "args": ["run", "--rm", "-e", "SIYUAN_HOST=127.0.0.1", "-e", "SIYUAN_PORT=6806", "-e", "SIYUAN_TOKEN=your-api-token-here", "zhizhiqq/siyuan-mcp:latest"],
      "env": {}
    }
  }
}
```

**Claude Desktop Docker Configuration**
```json
{
  "mcpServers": {
    "siyuan-mcp": {
      "command": "docker",
      "args": ["run", "--rm", "-e", "SIYUAN_HOST=127.0.0.1", "-e", "SIYUAN_PORT=6806", "-e", "SIYUAN_TOKEN=your-api-token-here", "zhizhiqq/siyuan-mcp:latest"],
      "env": {}
    }
  }
}
```

**Note**: When using Docker configuration, ensure Docker is installed and running.

### üîß Environment Variables

| Variable | Description | Default | Required |
|----------|-------------|---------|----------|
| `SIYUAN_HOST` | SiYuan server address | 127.0.0.1 | No |
| `SIYUAN_PORT` | SiYuan server port | 6806 | No |
| `SIYUAN_TOKEN` | API token | - | Yes |

### üìã Common Issues

#### Q: What if the connection fails?
**A:** Please check the following steps:
1. Ensure SiYuan Note is running
2. Check if the API token is correct
3. Confirm there are open notebooks in SiYuan Note
4. Restart SiYuan Note and Cursor

#### Q: How to get the correct API token?
**A:** 
1. Open SiYuan Note
2. Go to `Settings` ‚Üí `About` ‚Üí `API Token`
3. Click `Generate Token` or copy existing token
4. Ensure the token format is correct (usually a string of alphanumeric characters)

#### Q: Why use `-y` parameter with npx?
**A:** The `-y` parameter automatically confirms package installation without prompting for user input, which is essential for MCP client configurations where interactive prompts would cause connection failures.

### üéØ Features

#### üìö Notebook Management
Notebooks are the basic organizational units of SiYuan Note, each containing multiple documents.

- **`list_notebooks`** - List all notebooks, get notebook IDs and names
- **`open_notebook`** - Open specified notebook, activate workspace
- **`close_notebook`** - Close specified notebook, release resources
- **`rename_notebook`** - Rename notebook, update display name
- **`create_notebook`** - Create new notebook, support custom names
- **`remove_notebook`** - Delete notebook, clean related data
- **`get_notebook_conf`** - Get notebook configuration information
- **`set_notebook_conf`** - Save notebook configuration, custom settings

#### üìÑ Document Management
Documents are specific content units in notebooks, supporting hierarchical structure and path management.

- **`create_doc`** - Create new document in specified notebook, support Markdown content
- **`rename_doc`** - Rename document, keep content unchanged
- **`rename_doc_by_id`** - Rename by document ID, precise operation
- **`remove_doc`** - Delete document, clean file system
- **`remove_doc_by_id`** - Delete by document ID, precise operation
- **`move_docs`** - Move documents to other locations or notebooks
- **`move_docs_by_id`** - Move by document ID, precise operation
- **`get_hpath_by_path`** - Get human-readable path by path
- **`get_hpath_by_id`** - Get human-readable path by ID
- **`get_path_by_id`** - Get storage path by ID
- **`get_ids_by_hpath`** - Get IDs by human-readable path

#### üß© Block Operations
Blocks are the smallest content units in SiYuan Note, supporting flexible editing, reorganization, and referencing.

- **`insert_block`** - Insert block, support specified position and data type
- **`prepend_block`** - Insert prepend child block, add content at parent block beginning
- **`append_block`** - Insert append child block, add content at parent block end
- **`update_block`** - Update block content, support Markdown and DOM formats
- **`delete_block`** - Delete block, clean related references
- **`move_block`** - Move block to new position, support hierarchical adjustment
- **`get_block_kramdown`** - Get block kramdown source code, for export
- **`get_child_blocks`** - Get child block list, traverse block structure
- **`fold_block`** - Fold block, hide child content
- **`unfold_block`** - Unfold block, show child content
- **`transfer_block_ref`** - Transfer block reference, maintain reference relationships

#### üè∑Ô∏è Attribute Operations
Block attributes are used to store metadata and custom information, supporting key-value pair storage.

- **`set_block_attrs`** - Set block attributes, support custom key-value pairs
- **`get_block_attrs`** - Get block attributes, read metadata information

#### üîç Search and Query
Get data from SiYuan Note through SQL queries, supporting complex query conditions.

- **`sql_query`** - Execute SQL queries, support all SQLite syntax
- **`flush_transaction`** - Commit transactions, ensure data persistence

#### üìÅ File Operations
Manage files and directories in SiYuan Note workspace, support resource management.

- **`get_file`** - Get file content, read file data
- **`remove_file`** - Delete file, clean storage space
- **`rename_file`** - Rename file, update file path
- **`read_dir`** - List directory content, browse file structure
- **`put_file`** - Write file, create or update file content

#### üì§ Export Functions
Export SiYuan Note content to various formats, support backup and sharing.

- **`export_md_content`** - Export Markdown text, maintain format
- **`export_resources`** - Export files and directories, include resource files

#### üì¢ Notification Functions
Push messages and error prompts to users, provide operation feedback.

- **`push_msg`** - Push messages, display success prompts
- **`push_err_msg`** - Push error messages, display error information

#### üíª System Information
Get SiYuan Note system status and runtime information, monitor system health.

- **`get_version`** - Get SiYuan Note version information
- **`get_current_time`** - Get system current time
- **`get_boot_progress`** - Get boot progress, monitor boot status
- **`check_siyuan_status`** - Check SiYuan Note status and API availability
- **`get_workspace_info`** - Get workspace and connection information

#### üé® Template Functions
Use template system to create dynamic content, support variable substitution.

- **`render_template`** - Render template files, support external templates
- **`render_sprig`** - Render Sprig templates, support inline template syntax

#### üîÑ Conversion Functions
Use Pandoc for document format conversion, support multiple output formats.

- **`pandoc_convert`** - Pandoc conversion, support multiple document formats

#### üìé Resource Files
Manage resource files in SiYuan Note, support batch upload.

- **`upload_asset`** - Upload resource files, support batch operations

### üîß Core Features

#### üöÄ High Performance
- **Asynchronous Processing**: All API calls use asynchronous processing for faster response
- **Batch Operations**: Support batch document movement and block operations for improved efficiency
- **Transaction Management**: Built-in transaction mechanism ensures data consistency

#### üõ°Ô∏è Secure and Reliable
- **Authentication**: Support API token authentication to protect data security
- **Error Handling**: Comprehensive error handling mechanism provides detailed error information
- **Parameter Validation**: Strict parameter validation prevents invalid operations

#### üîå Easy Integration
- **MCP Protocol**: Based on Model Context Protocol, easy to integrate with AI tools
- **Standard Interface**: Follows SiYuan Note official API specifications
- **Multi-language Support**: Supports Chinese and English documentation and error messages

#### üìä Data Management
- **Complete CRUD**: Support create, read, update, delete for all data types
- **Hierarchical Structure**: Support hierarchical organization of documents and blocks
- **Reference System**: Support block references and transfers, maintain data relationships

#### üéØ Developer Friendly
- **Detailed Logging**: Provide detailed API call logs for easy debugging
- **Status Checking**: Built-in connection status checking for quick problem diagnosis
- **Rich Examples**: Provide complete usage examples and best practices

### üìä API Statistics

- **Total APIs**: 49
- **Feature Modules**: 12
- **Supported Operations**: Complete SiYuan Note API functionality
- **Coverage**: 100% SiYuan Note official API (except network APIs)

### üìö Usage Examples

**List all notebooks**
```json
{
  "name": "list_notebooks",
  "arguments": {}
}
```

**Create new document**
```json
{
  "name": "create_doc",
  "arguments": {
    "notebook": "20241009135857-599ipbh",
    "path": "/daily/2025-01-15",
    "markdown": "# Today's Summary\n\nToday I completed the following work:\n- Project development\n- Document writing"
  }
}
```

**Query recently created documents**
```json
{
  "name": "sql_query",
  "arguments": {
    "sql": "SELECT * FROM blocks WHERE type = 'd' ORDER BY created DESC LIMIT 5"
  }
}
```

**Find blocks with specific tags**
```json
{
  "name": "sql_query",
  "arguments": {
    "sql": "SELECT * FROM blocks WHERE content LIKE '%#important%' OR content LIKE '%#urgent%'"
  }
}
```

**Insert block**
```json
{
  "name": "insert_block",
  "arguments": {
    "data": "This is new block content",
    "dataType": "markdown",
    "parentID": "20250803150424-tu1cl78"
  }
}
```

### üìö Development Resources

#### Related Links
- [SiYuan Note Official Documentation](https://b3log.org/siyuan/)
- [SiYuan Note Download](https://b3log.org/siyuan/download.html)
- [SiYuan Note API Documentation](https://github.com/siyuan-note/siyuan/blob/master/API_zh_CN.md)
- [Model Context Protocol](https://modelcontextprotocol.io/)

#### Community Support
- [SiYuan Note Community](https://b3log.org/siyuan/)
- [GitHub Issues](https://github.com/xgq18237/siyuan_mcp_server/issues)

#### Technology Stack
- **Language**: TypeScript/JavaScript
- **Protocol**: Model Context Protocol (MCP)
- **Framework**: @modelcontextprotocol/sdk
- **Deployment**: Docker, Node.js
- **Database**: SQLite (via SiYuan Note)

#### Development Tools
- **Editor**: VS Code, Cursor
- **Build Tool**: TypeScript Compiler
- **Package Manager**: npm
- **Containerization**: Docker, Docker Compose

### üîß Advanced Features

#### 1. Template System
Use `render_template` and `render_sprig` to create dynamic content:
```json
{
  "name": "render_sprig",
  "arguments": {
    "template": "Hello {{.name}}! Today is {{.date}}."
  }
}
```

#### 2. File Management
Use file operation APIs to manage attachments and resources:
```json
{
  "name": "upload_asset",
  "arguments": {
    "assetsDirPath": "/assets",
    "files": ["image1.jpg", "document.pdf"]
  }
}
```

#### 3. Data Export
Use export functions to backup and share content:
```json
{
  "name": "export_md_content",
  "arguments": {
    "id": "20250115123456-abcdef"
  }
}
```

### üõ†Ô∏è Local Development

#### Global Installation
```bash
npm install -g siyuan-mcp
siyuan-mcp
```

#### Environment Requirements
- Node.js >= 18.0.0
- npm or yarn
- Git

#### Clone Project
```bash
git clone https://github.com/xgq18237/siyuan_mcp_server.git
cd siyuan_mcp_server
```

#### Install Dependencies
```bash
npm install
```

#### Build Project
```bash
npm run build
```

#### Development Mode
```bash
npm run dev
```

#### Start Server
```bash
npm start
```

#### Docker Local Deployment

1. **Build Image**
```bash
docker build -t siyuan-mcp-server .
```

2. **Run Container**
```bash
docker run -d \
  -e SIYUAN_HOST=127.0.0.1 \
  -e SIYUAN_PORT=6806 \
  -e SIYUAN_TOKEN=your-token \
  --name siyuan-mcp-server \
  siyuan-mcp-server
```

3. **Using Docker Compose**
```bash
# Configure environment variables
cp env.example .env
# Edit .env file

# Start service
docker-compose up -d
```

### üìÑ License

MIT License

---

**[‚¨Ü Back to Top](#ÊÄùÊ∫êÁ¨îËÆ∞-mcp-ÊúçÂä°Âô®--siyuan-mcp-server)**

---

## ‰∏≠ÊñáÁâàÊú¨

ËøôÊòØ‰∏Ä‰∏™Âü∫‰∫é [Model Context Protocol (MCP)](https://modelcontextprotocol.io/) ÁöÑÊÄùÊ∫êÁ¨îËÆ∞ÊúçÂä°Âô®ÔºåÊèê‰æõ‰∫ÜÂÆåÊï¥ÁöÑÊÄùÊ∫êÁ¨îËÆ∞ API ÂäüËÉΩ„ÄÇ

### üöÄ Âø´ÈÄüÂºÄÂßã

#### ‰ΩøÁî® npxÔºàÊé®ËçêÔºâ
```bash
# Áõ¥Êé•ËøêË°å
npx -y siyuan-mcp@latest

# ËÆæÁΩÆÁéØÂ¢ÉÂèòÈáè
SIYUAN_HOST=127.0.0.1 SIYUAN_PORT=6806 SIYUAN_TOKEN=your-token npx -y siyuan-mcp@latest
```

#### ‰ΩøÁî® Docker
```bash
# ÊãâÂèñÈïúÂÉè
docker pull zhizhiqq/siyuan-mcp:latest

# ËøêË°åÂÆπÂô®
docker run -d \
  -e SIYUAN_HOST=127.0.0.1 \
  -e SIYUAN_PORT=6806 \
  -e SIYUAN_TOKEN=your-token \
  --name siyuan-mcp-server \
  zhizhiqq/siyuan-mcp:latest
```

#### ÈÖçÁΩÆ MCP ÂÆ¢Êà∑Á´Ø

##### Cursor ÈÖçÁΩÆ
1. ÊâìÂºÄ Cursor ËÆæÁΩÆÔºàCtrl/Cmd + ,Ôºâ
2. ÊêúÁ¥¢ "MCP" Êàñ "Model Context Protocol"
3. ÁÇπÂáª "Add Server" Êàñ "Ê∑ªÂä†ÊúçÂä°Âô®"
4. ÈÖçÁΩÆÊúçÂä°Âô®‰ø°ÊÅØÔºö
```json
{
  "mcpServers": {
    "siyuan-mcp": {
      "command": "npx",
      "args": ["-y", "siyuan-mcp@latest"],
      "env": {
        "SIYUAN_HOST": "127.0.0.1",
        "SIYUAN_PORT": "6806",
        "SIYUAN_TOKEN": "your-api-token-here"
      }
    }
  }
}
```

##### Claude Desktop ÈÖçÁΩÆ
1. ÊâìÂºÄ Claude Desktop ËÆæÁΩÆ
2. ËøõÂÖ• "Model Context Protocol" ËÆæÁΩÆ
3. Ê∑ªÂä†Êñ∞ÁöÑ MCP ÊúçÂä°Âô®Ôºö
```json
{
  "mcpServers": {
    "siyuan-mcp": {
      "command": "npx",
      "args": ["-y", "siyuan-mcp@latest"],
      "env": {
        "SIYUAN_HOST": "127.0.0.1",
        "SIYUAN_PORT": "6806",
        "SIYUAN_TOKEN": "your-api-token-here"
      }
    }
  }
}
```

##### Docker ÈÖçÁΩÆ
Â¶ÇÊûú‰Ω†‰ΩøÁî® Docker ËøêË°åÊúçÂä°ÔºåÂèØ‰ª•ÈÖçÁΩÆÂÆ¢Êà∑Á´ØËøûÊé•Âà∞ Docker ÂÆπÂô®Ôºö

**Cursor Docker ÈÖçÁΩÆ**
```json
{
  "mcpServers": {
    "siyuan-mcp": {
      "command": "docker",
      "args": ["run", "--rm", "-e", "SIYUAN_HOST=127.0.0.1", "-e", "SIYUAN_PORT=6806", "-e", "SIYUAN_TOKEN=your-api-token-here", "zhizhiqq/siyuan-mcp:latest"],
      "env": {}
    }
  }
}
```

**Claude Desktop Docker ÈÖçÁΩÆ**
```json
{
  "mcpServers": {
    "siyuan-mcp": {
      "command": "docker",
      "args": ["run", "--rm", "-e", "SIYUAN_HOST=127.0.0.1", "-e", "SIYUAN_PORT=6806", "-e", "SIYUAN_TOKEN=your-api-token-here", "zhizhiqq/siyuan-mcp:latest"],
      "env": {}
    }
  }
}
```

**Ê≥®ÊÑè**Ôºö‰ΩøÁî® Docker ÈÖçÁΩÆÊó∂ÔºåÁ°Æ‰øù Docker Â∑≤ÂÆâË£ÖÂπ∂Ê≠£Âú®ËøêË°å„ÄÇ

### üîß ÁéØÂ¢ÉÂèòÈáèÈÖçÁΩÆ

| ÂèòÈáèÂêç | ËØ¥Êòé | ÈªòËÆ§ÂÄº | ÂøÖÈúÄ |
|--------|------|--------|------|
| `SIYUAN_HOST` | ÊÄùÊ∫êÁ¨îËÆ∞ÊúçÂä°Âô®Âú∞ÂùÄ | 127.0.0.1 | Âê¶ |
| `SIYUAN_PORT` | ÊÄùÊ∫êÁ¨îËÆ∞ÊúçÂä°Âô®Á´ØÂè£ | 6806 | Âê¶ |
| `SIYUAN_TOKEN` | API ‰ª§Áâå | - | ÊòØ |

### üìã Â∏∏ËßÅÈóÆÈ¢ò

#### Q: ËøûÊé•Â§±Ë¥•ÊÄé‰πàÂäûÔºü
**A:** ËØ∑Êåâ‰ª•‰∏ãÊ≠•È™§Ê£ÄÊü•Ôºö
1. Á°Æ‰øùÊÄùÊ∫êÁ¨îËÆ∞Ê≠£Âú®ËøêË°å
2. Ê£ÄÊü• API ‰ª§ÁâåÊòØÂê¶Ê≠£Á°Æ
3. Á°ÆËÆ§ÊÄùÊ∫êÁ¨îËÆ∞‰∏≠ÊúâÊâìÂºÄÁöÑÁ¨îËÆ∞Êú¨
4. ÈáçÂêØÊÄùÊ∫êÁ¨îËÆ∞Âíå Cursor

#### Q: Â¶Ç‰ΩïËé∑ÂèñÊ≠£Á°ÆÁöÑ API ‰ª§ÁâåÔºü
**A:** 
1. ÊâìÂºÄÊÄùÊ∫êÁ¨îËÆ∞
2. ËøõÂÖ• `ËÆæÁΩÆ` ‚Üí `ÂÖ≥‰∫é` ‚Üí `API ‰ª§Áâå`
3. ÁÇπÂáª `ÁîüÊàê‰ª§Áâå` ÊàñÂ§çÂà∂Áé∞Êúâ‰ª§Áâå
4. Á°Æ‰øù‰ª§ÁâåÊ†ºÂºèÊ≠£Á°ÆÔºàÈÄöÂ∏∏ÊòØ‰∏Ä‰∏≤Â≠óÊØçÊï∞Â≠óÁªÑÂêàÔºâ

#### Q: ‰∏∫‰ªÄ‰πà‰ΩøÁî® `-y` ÂèÇÊï∞Ôºü
**A:** `-y` ÂèÇÊï∞ÂèØ‰ª•Ëá™Âä®Á°ÆËÆ§ÂåÖÂÆâË£ÖÔºåÊó†ÈúÄÁî®Êà∑‰∫§‰∫íÁ°ÆËÆ§ÔºåËøôÂØπ‰∫é MCP ÂÆ¢Êà∑Á´ØÈÖçÁΩÆÈùûÂ∏∏ÈáçË¶ÅÔºåÂõ†‰∏∫‰∫§‰∫íÂºèÊèêÁ§∫‰ºöÂØºËá¥ËøûÊé•Â§±Ë¥•„ÄÇ



### üéØ ÂäüËÉΩÁâπÊÄß

#### üìö Á¨îËÆ∞Êú¨ÁÆ°ÁêÜ
Á¨îËÆ∞Êú¨ÊòØÊÄùÊ∫êÁ¨îËÆ∞ÁöÑÂü∫Êú¨ÁªÑÁªáÂçï‰ΩçÔºåÊØè‰∏™Á¨îËÆ∞Êú¨ÂåÖÂê´Â§ö‰∏™ÊñáÊ°£„ÄÇ

- **`list_notebooks`** - ÂàóÂá∫ÊâÄÊúâÁ¨îËÆ∞Êú¨ÔºåËé∑ÂèñÁ¨îËÆ∞Êú¨IDÂíåÂêçÁß∞
- **`open_notebook`** - ÊâìÂºÄÊåáÂÆöÁ¨îËÆ∞Êú¨ÔºåÊøÄÊ¥ªÂ∑•‰ΩúÁ©∫Èó¥
- **`close_notebook`** - ÂÖ≥Èó≠ÊåáÂÆöÁ¨îËÆ∞Êú¨ÔºåÈáäÊîæËµÑÊ∫ê
- **`rename_notebook`** - ÈáçÂëΩÂêçÁ¨îËÆ∞Êú¨ÔºåÊõ¥Êñ∞ÊòæÁ§∫ÂêçÁß∞
- **`create_notebook`** - ÂàõÂª∫Êñ∞Á¨îËÆ∞Êú¨ÔºåÊîØÊåÅËá™ÂÆö‰πâÂêçÁß∞
- **`remove_notebook`** - Âà†Èô§Á¨îËÆ∞Êú¨ÔºåÊ∏ÖÁêÜÁõ∏ÂÖ≥Êï∞ÊçÆ
- **`get_notebook_conf`** - Ëé∑ÂèñÁ¨îËÆ∞Êú¨ÈÖçÁΩÆ‰ø°ÊÅØ
- **`set_notebook_conf`** - ‰øùÂ≠òÁ¨îËÆ∞Êú¨ÈÖçÁΩÆÔºåËá™ÂÆö‰πâËÆæÁΩÆ

#### üìÑ ÊñáÊ°£ÁÆ°ÁêÜ
ÊñáÊ°£ÊòØÁ¨îËÆ∞Êú¨‰∏≠ÁöÑÂÖ∑‰ΩìÂÜÖÂÆπÂçïÂÖÉÔºåÊîØÊåÅÂ±ÇÁ∫ßÁªìÊûÑÂíåË∑ØÂæÑÁÆ°ÁêÜ„ÄÇ

- **`create_doc`** - Âú®ÊåáÂÆöÁ¨îËÆ∞Êú¨‰∏≠Êñ∞Âª∫ÊñáÊ°£ÔºåÊîØÊåÅMarkdownÂÜÖÂÆπ
- **`rename_doc`** - ÈáçÂëΩÂêçÊñáÊ°£Ôºå‰øùÊåÅÂÜÖÂÆπ‰∏çÂèò
- **`rename_doc_by_id`** - Ê†πÊçÆÊñáÊ°£IDÈáçÂëΩÂêçÔºåÁ≤æÁ°ÆÊìç‰Ωú
- **`remove_doc`** - Âà†Èô§ÊñáÊ°£ÔºåÊ∏ÖÁêÜÊñá‰ª∂Á≥ªÁªü
- **`remove_doc_by_id`** - Ê†πÊçÆÊñáÊ°£IDÂà†Èô§ÔºåÁ≤æÁ°ÆÊìç‰Ωú
- **`move_docs`** - ÁßªÂä®ÊñáÊ°£Âà∞ÂÖ∂‰ªñ‰ΩçÁΩÆÊàñÁ¨îËÆ∞Êú¨
- **`move_docs_by_id`** - Ê†πÊçÆÊñáÊ°£IDÁßªÂä®ÔºåÁ≤æÁ°ÆÊìç‰Ωú
- **`get_hpath_by_path`** - Ê†πÊçÆË∑ØÂæÑËé∑Âèñ‰∫∫Á±ªÂèØËØªË∑ØÂæÑ
- **`get_hpath_by_id`** - Ê†πÊçÆIDËé∑Âèñ‰∫∫Á±ªÂèØËØªË∑ØÂæÑ
- **`get_path_by_id`** - Ê†πÊçÆIDËé∑ÂèñÂ≠òÂÇ®Ë∑ØÂæÑ
- **`get_ids_by_hpath`** - Ê†πÊçÆ‰∫∫Á±ªÂèØËØªË∑ØÂæÑËé∑ÂèñIDs

#### üß© ÂùóÊìç‰Ωú
ÂùóÊòØÊÄùÊ∫êÁ¨îËÆ∞ÁöÑÊúÄÂ∞èÂÜÖÂÆπÂçï‰ΩçÔºåÊîØÊåÅÁÅµÊ¥ªÁöÑÁºñËæë„ÄÅÈáçÁªÑÂíåÂºïÁî®„ÄÇ

- **`insert_block`** - ÊèíÂÖ•ÂùóÔºåÊîØÊåÅÊåáÂÆö‰ΩçÁΩÆÂíåÊï∞ÊçÆÁ±ªÂûã
- **`prepend_block`** - ÊèíÂÖ•ÂâçÁΩÆÂ≠êÂùóÔºåÂú®Áà∂ÂùóÂºÄÂ§¥Ê∑ªÂä†ÂÜÖÂÆπ
- **`append_block`** - ÊèíÂÖ•ÂêéÁΩÆÂ≠êÂùóÔºåÂú®Áà∂ÂùóÊú´Â∞æÊ∑ªÂä†ÂÜÖÂÆπ
- **`update_block`** - Êõ¥Êñ∞ÂùóÂÜÖÂÆπÔºåÊîØÊåÅMarkdownÂíåDOMÊ†ºÂºè
- **`delete_block`** - Âà†Èô§ÂùóÔºåÊ∏ÖÁêÜÁõ∏ÂÖ≥ÂºïÁî®
- **`move_block`** - ÁßªÂä®ÂùóÂà∞Êñ∞‰ΩçÁΩÆÔºåÊîØÊåÅÂ±ÇÁ∫ßË∞ÉÊï¥
- **`get_block_kramdown`** - Ëé∑ÂèñÂùókramdownÊ∫êÁ†ÅÔºåÁî®‰∫éÂØºÂá∫
- **`get_child_blocks`** - Ëé∑ÂèñÂ≠êÂùóÂàóË°®ÔºåÈÅçÂéÜÂùóÁªìÊûÑ
- **`fold_block`** - ÊäòÂè†ÂùóÔºåÈöêËóèÂ≠êÂÜÖÂÆπ
- **`unfold_block`** - Â±ïÂºÄÂùóÔºåÊòæÁ§∫Â≠êÂÜÖÂÆπ
- **`transfer_block_ref`** - ËΩ¨ÁßªÂùóÂºïÁî®ÔºåÁª¥Êä§ÂºïÁî®ÂÖ≥Á≥ª

#### üè∑Ô∏è Â±ûÊÄßÊìç‰Ωú
ÂùóÂ±ûÊÄßÁî®‰∫éÂ≠òÂÇ®ÂÖÉÊï∞ÊçÆÂíåËá™ÂÆö‰πâ‰ø°ÊÅØÔºåÊîØÊåÅÈîÆÂÄºÂØπÂ≠òÂÇ®„ÄÇ

- **`set_block_attrs`** - ËÆæÁΩÆÂùóÂ±ûÊÄßÔºåÊîØÊåÅËá™ÂÆö‰πâÈîÆÂÄºÂØπ
- **`get_block_attrs`** - Ëé∑ÂèñÂùóÂ±ûÊÄßÔºåËØªÂèñÂÖÉÊï∞ÊçÆ‰ø°ÊÅØ

#### üîç ÊêúÁ¥¢ÂíåÊü•ËØ¢
ÈÄöËøáSQLÊü•ËØ¢Ëé∑ÂèñÊÄùÊ∫êÁ¨îËÆ∞‰∏≠ÁöÑÊï∞ÊçÆÔºåÊîØÊåÅÂ§çÊùÇÊü•ËØ¢Êù°‰ª∂„ÄÇ

- **`sql_query`** - ÊâßË°åSQLÊü•ËØ¢ÔºåÊîØÊåÅÊâÄÊúâSQLiteËØ≠Ê≥ï
- **`flush_transaction`** - Êèê‰∫§‰∫ãÂä°ÔºåÁ°Æ‰øùÊï∞ÊçÆÊåÅ‰πÖÂåñ

#### üìÅ Êñá‰ª∂Êìç‰Ωú
ÁÆ°ÁêÜÊÄùÊ∫êÁ¨îËÆ∞Â∑•‰ΩúÁ©∫Èó¥‰∏≠ÁöÑÊñá‰ª∂ÂíåÁõÆÂΩïÔºåÊîØÊåÅËµÑÊ∫êÁÆ°ÁêÜ„ÄÇ

- **`get_file`** - Ëé∑ÂèñÊñá‰ª∂ÂÜÖÂÆπÔºåËØªÂèñÊñá‰ª∂Êï∞ÊçÆ
- **`remove_file`** - Âà†Èô§Êñá‰ª∂ÔºåÊ∏ÖÁêÜÂ≠òÂÇ®Á©∫Èó¥
- **`rename_file`** - ÈáçÂëΩÂêçÊñá‰ª∂ÔºåÊõ¥Êñ∞Êñá‰ª∂Ë∑ØÂæÑ
- **`read_dir`** - ÂàóÂá∫ÁõÆÂΩïÂÜÖÂÆπÔºåÊµèËßàÊñá‰ª∂ÁªìÊûÑ
- **`put_file`** - ÂÜôÂÖ•Êñá‰ª∂ÔºåÂàõÂª∫ÊàñÊõ¥Êñ∞Êñá‰ª∂ÂÜÖÂÆπ

#### üì§ ÂØºÂá∫ÂäüËÉΩ
Â∞ÜÊÄùÊ∫êÁ¨îËÆ∞ÂÜÖÂÆπÂØºÂá∫‰∏∫ÂêÑÁßçÊ†ºÂºèÔºåÊîØÊåÅÂ§á‰ªΩÂíåÂàÜ‰∫´„ÄÇ

- **`export_md_content`** - ÂØºÂá∫MarkdownÊñáÊú¨Ôºå‰øùÊåÅÊ†ºÂºè
- **`export_resources`** - ÂØºÂá∫Êñá‰ª∂‰∏éÁõÆÂΩïÔºåÂåÖÂê´ËµÑÊ∫êÊñá‰ª∂

#### üì¢ ÈÄöÁü•ÂäüËÉΩ
ÂêëÁî®Êà∑Êé®ÈÄÅÊ∂àÊÅØÂíåÈîôËØØÊèêÁ§∫ÔºåÊèê‰æõÊìç‰ΩúÂèçÈ¶à„ÄÇ

- **`push_msg`** - Êé®ÈÄÅÊ∂àÊÅØÔºåÊòæÁ§∫ÊàêÂäüÊèêÁ§∫
- **`push_err_msg`** - Êé®ÈÄÅÈîôËØØÊ∂àÊÅØÔºåÊòæÁ§∫ÈîôËØØ‰ø°ÊÅØ

#### üíª Á≥ªÁªü‰ø°ÊÅØ
Ëé∑ÂèñÊÄùÊ∫êÁ¨îËÆ∞Á≥ªÁªüÁä∂ÊÄÅÂíåËøêË°å‰ø°ÊÅØÔºåÁõëÊéßÁ≥ªÁªüÂÅ•Â∫∑„ÄÇ

- **`get_version`** - Ëé∑ÂèñÊÄùÊ∫êÁ¨îËÆ∞ÁâàÊú¨‰ø°ÊÅØ
- **`get_current_time`** - Ëé∑ÂèñÁ≥ªÁªüÂΩìÂâçÊó∂Èó¥
- **`get_boot_progress`** - Ëé∑ÂèñÂêØÂä®ËøõÂ∫¶ÔºåÁõëÊéßÂêØÂä®Áä∂ÊÄÅ
- **`check_siyuan_status`** - Ê£ÄÊü•ÊÄùÊ∫êÁ¨îËÆ∞Áä∂ÊÄÅÂíåAPIÂèØÁî®ÊÄß
- **`get_workspace_info`** - Ëé∑ÂèñÂ∑•‰ΩúÁ©∫Èó¥ÂíåËøûÊé•‰ø°ÊÅØ

#### üé® Ê®°ÊùøÂäüËÉΩ
‰ΩøÁî®Ê®°ÊùøÁ≥ªÁªüÂàõÂª∫Âä®ÊÄÅÂÜÖÂÆπÔºåÊîØÊåÅÂèòÈáèÊõøÊç¢„ÄÇ

- **`render_template`** - Ê∏≤ÊüìÊ®°ÊùøÊñá‰ª∂ÔºåÊîØÊåÅÂ§ñÈÉ®Ê®°Êùø
- **`render_sprig`** - Ê∏≤ÊüìSprigÊ®°ÊùøÔºåÊîØÊåÅÂÜÖËÅîÊ®°ÊùøËØ≠Ê≥ï

#### üîÑ ËΩ¨Êç¢ÂäüËÉΩ
‰ΩøÁî®PandocËøõË°åÊñáÊ°£Ê†ºÂºèËΩ¨Êç¢ÔºåÊîØÊåÅÂ§öÁßçËæìÂá∫Ê†ºÂºè„ÄÇ

- **`pandoc_convert`** - PandocËΩ¨Êç¢ÔºåÊîØÊåÅÂ§öÁßçÊñáÊ°£Ê†ºÂºè

#### üìé ËµÑÊ∫êÊñá‰ª∂
ÁÆ°ÁêÜÊÄùÊ∫êÁ¨îËÆ∞‰∏≠ÁöÑËµÑÊ∫êÊñá‰ª∂ÔºåÊîØÊåÅÊâπÈáè‰∏ä‰º†„ÄÇ

- **`upload_asset`** - ‰∏ä‰º†ËµÑÊ∫êÊñá‰ª∂ÔºåÊîØÊåÅÊâπÈáèÊìç‰Ωú

### üîß Ê†∏ÂøÉÁâπÊÄß

#### üöÄ È´òÊÄßËÉΩ
- **ÂºÇÊ≠•Â§ÑÁêÜ**: ÊâÄÊúâAPIË∞ÉÁî®ÈááÁî®ÂºÇÊ≠•Â§ÑÁêÜÔºåÊèêÈ´òÂìçÂ∫îÈÄüÂ∫¶
- **ÊâπÈáèÊìç‰Ωú**: ÊîØÊåÅÊâπÈáèÊñáÊ°£ÁßªÂä®ÂíåÂùóÊìç‰ΩúÔºåÊèêÂçáÊïàÁéá
- **‰∫ãÂä°ÁÆ°ÁêÜ**: ÂÜÖÁΩÆ‰∫ãÂä°Êú∫Âà∂ÔºåÁ°Æ‰øùÊï∞ÊçÆ‰∏ÄËá¥ÊÄß

#### üõ°Ô∏è ÂÆâÂÖ®ÂèØÈù†
- **Ë∫´‰ªΩÈ™åËØÅ**: ÊîØÊåÅAPI‰ª§ÁâåËÆ§ËØÅÔºå‰øùÊä§Êï∞ÊçÆÂÆâÂÖ®
- **ÈîôËØØÂ§ÑÁêÜ**: ÂÆåÂñÑÁöÑÈîôËØØÂ§ÑÁêÜÊú∫Âà∂ÔºåÊèê‰æõËØ¶ÁªÜÈîôËØØ‰ø°ÊÅØ
- **ÂèÇÊï∞È™åËØÅ**: ‰∏•Ê†ºÁöÑÂèÇÊï∞È™åËØÅÔºåÈò≤Ê≠¢Êó†ÊïàÊìç‰Ωú

#### üîå Êòì‰∫éÈõÜÊàê
- **MCPÂçèËÆÆ**: Âü∫‰∫éModel Context ProtocolÔºåÊòì‰∫é‰∏éAIÂ∑•ÂÖ∑ÈõÜÊàê
- **Ê†áÂáÜÊé•Âè£**: ÈÅµÂæ™ÊÄùÊ∫êÁ¨îËÆ∞ÂÆòÊñπAPIËßÑËåÉ
- **Â§öËØ≠Ë®ÄÊîØÊåÅ**: ÊîØÊåÅ‰∏≠Ëã±ÊñáÊñáÊ°£ÂíåÈîôËØØ‰ø°ÊÅØ

#### üìä Êï∞ÊçÆÁÆ°ÁêÜ
- **ÂÆåÊï¥CRUD**: ÊîØÊåÅÂàõÂª∫„ÄÅËØªÂèñ„ÄÅÊõ¥Êñ∞„ÄÅÂà†Èô§ÊâÄÊúâÊï∞ÊçÆÁ±ªÂûã
- **Â±ÇÁ∫ßÁªìÊûÑ**: ÊîØÊåÅÊñáÊ°£ÂíåÂùóÁöÑÂ±ÇÁ∫ßÁªÑÁªá
- **ÂºïÁî®Á≥ªÁªü**: ÊîØÊåÅÂùóÂºïÁî®ÂíåËΩ¨ÁßªÔºåÁª¥Êä§Êï∞ÊçÆÂÖ≥Á≥ª

#### üéØ ÂºÄÂèëÂèãÂ•Ω
- **ËØ¶ÁªÜÊó•Âøó**: Êèê‰æõËØ¶ÁªÜÁöÑAPIË∞ÉÁî®Êó•ÂøóÔºå‰æø‰∫éË∞ÉËØï
- **Áä∂ÊÄÅÊ£ÄÊü•**: ÂÜÖÁΩÆËøûÊé•Áä∂ÊÄÅÊ£ÄÊü•ÔºåÂø´ÈÄüËØäÊñ≠ÈóÆÈ¢ò
- **Á§∫‰æã‰∏∞ÂØå**: Êèê‰æõÂÆåÊï¥ÁöÑ‰ΩøÁî®Á§∫‰æãÂíåÊúÄ‰Ω≥ÂÆûË∑µ

### üìä Êé•Âè£ÁªüËÆ°

- **ÊÄªÊé•Âè£Êï∞**: 49‰∏™
- **ÂäüËÉΩÊ®°Âùó**: 12‰∏™
- **ÊîØÊåÅÁöÑÊìç‰Ωú**: ÂÆåÊï¥ÁöÑÊÄùÊ∫êÁ¨îËÆ∞APIÂäüËÉΩ
- **Ë¶ÜÁõñËåÉÂõ¥**: 100%ÊÄùÊ∫êÁ¨îËÆ∞ÂÆòÊñπAPIÔºàÈô§ÁΩëÁªúÊé•Âè£Â§ñÔºâ

### üìö ‰ΩøÁî®Á§∫‰æã

**ÂàóÂá∫ÊâÄÊúâÁ¨îËÆ∞Êú¨**
```json
{
  "name": "list_notebooks",
  "arguments": {}
}
```

**ÂàõÂª∫Êñ∞ÊñáÊ°£**
```json
{
  "name": "create_doc",
  "arguments": {
    "notebook": "20241009135857-599ipbh",
    "path": "/daily/2025-01-15",
    "markdown": "# ‰ªäÊó•ÊÄªÁªì\n\n‰ªäÂ§©ÂÆåÊàê‰∫Ü‰ª•‰∏ãÂ∑•‰ΩúÔºö\n- È°πÁõÆÂºÄÂèë\n- ÊñáÊ°£ÁºñÂÜô"
  }
}
```

**Êü•ËØ¢ÊúÄËøëÂàõÂª∫ÁöÑÊñáÊ°£**
```json
{
  "name": "sql_query",
  "arguments": {
    "sql": "SELECT * FROM blocks WHERE type = 'd' ORDER BY created DESC LIMIT 5"
  }
}
```

**Êü•ÊâæÂåÖÂê´ÁâπÂÆöÊ†áÁ≠æÁöÑÂùó**
```json
{
  "name": "sql_query",
  "arguments": {
    "sql": "SELECT * FROM blocks WHERE content LIKE '%#ÈáçË¶Å%' OR content LIKE '%#urgent%'"
  }
}
```

**ÊèíÂÖ•Âùó**
```json
{
  "name": "insert_block",
  "arguments": {
    "data": "ËøôÊòØ‰∏Ä‰∏™Êñ∞ÁöÑÂùóÂÜÖÂÆπ",
    "dataType": "markdown",
    "parentID": "20250803150424-tu1cl78"
  }
}
```



### üìö ÂºÄÂèëËµÑÊ∫ê

#### Áõ∏ÂÖ≥ÈìæÊé•
- [ÊÄùÊ∫êÁ¨îËÆ∞ÂÆòÊñπÊñáÊ°£](https://b3log.org/siyuan/)
- [ÊÄùÊ∫êÁ¨îËÆ∞‰∏ãËΩΩÂú∞ÂùÄ](https://b3log.org/siyuan/download.html)
- [ÊÄùÊ∫êÁ¨îËÆ∞APIÊñáÊ°£](https://github.com/siyuan-note/siyuan/blob/master/API_zh_CN.md)
- [Model Context Protocol](https://modelcontextprotocol.io/)

#### Á§æÂå∫ÊîØÊåÅ
- [ÊÄùÊ∫êÁ¨îËÆ∞Á§æÂå∫](https://b3log.org/siyuan/)
- [GitHub Issues](https://github.com/xgq18237/siyuan_mcp_server/issues)

#### ÊäÄÊúØÊ†à
- **ËØ≠Ë®Ä**: TypeScript/JavaScript
- **ÂçèËÆÆ**: Model Context Protocol (MCP)
- **Ê°ÜÊû∂**: @modelcontextprotocol/sdk
- **ÈÉ®ÁΩ≤**: Docker, Node.js
- **Êï∞ÊçÆÂ∫ì**: SQLite (ÈÄöËøáÊÄùÊ∫êÁ¨îËÆ∞)

#### ÂºÄÂèëÂ∑•ÂÖ∑
- **ÁºñËæëÂô®**: VS Code, Cursor
- **ÊûÑÂª∫Â∑•ÂÖ∑**: TypeScript Compiler
- **ÂåÖÁÆ°ÁêÜ**: npm
- **ÂÆπÂô®Âåñ**: Docker, Docker Compose

### üîß È´òÁ∫ßÂäüËÉΩ

#### 1. Ê®°ÊùøÁ≥ªÁªü
‰ΩøÁî®`render_template`Âíå`render_sprig`ÂàõÂª∫Âä®ÊÄÅÂÜÖÂÆπÔºö
```json
{
  "name": "render_sprig",
  "arguments": {
    "template": "Hello {{.name}}! Today is {{.date}}."
  }
}
```

#### 2. Êñá‰ª∂ÁÆ°ÁêÜ
‰ΩøÁî®Êñá‰ª∂Êìç‰ΩúAPIÁÆ°ÁêÜÈôÑ‰ª∂ÂíåËµÑÊ∫êÔºö
```json
{
  "name": "upload_asset",
  "arguments": {
    "assetsDirPath": "/assets",
    "files": ["image1.jpg", "document.pdf"]
  }
}
```

#### 3. Êï∞ÊçÆÂØºÂá∫
‰ΩøÁî®ÂØºÂá∫ÂäüËÉΩÂ§á‰ªΩÂíåÂàÜ‰∫´ÂÜÖÂÆπÔºö
```json
{
  "name": "export_md_content",
  "arguments": {
    "id": "20250115123456-abcdef"
  }
}
```

### üõ†Ô∏è Êú¨Âú∞ÂºÄÂèë

#### ÂÖ®Â±ÄÂÆâË£Ö
```bash
npm install -g siyuan-mcp
siyuan-mcp
```

#### ÁéØÂ¢ÉË¶ÅÊ±Ç
- Node.js >= 18.0.0
- npm Êàñ yarn
- Git

#### ÂÖãÈöÜÈ°πÁõÆ
```bash
git clone https://github.com/xgq18237/siyuan_mcp_server.git
cd siyuan_mcp_server
```

#### ÂÆâË£Ö‰æùËµñ
```bash
npm install
```

#### ÊûÑÂª∫È°πÁõÆ
```bash
npm run build
```

#### ÂºÄÂèëÊ®°Âºè
```bash
npm run dev
```

#### ÂêØÂä®ÊúçÂä°Âô®
```bash
npm start
```

#### Docker Êú¨Âú∞ÈÉ®ÁΩ≤

1. **ÊûÑÂª∫ÈïúÂÉè**
```bash
docker build -t siyuan-mcp-server .
```

2. **ËøêË°åÂÆπÂô®**
```bash
docker run -d \
  -e SIYUAN_HOST=127.0.0.1 \
  -e SIYUAN_PORT=6806 \
  -e SIYUAN_TOKEN=your-token \
  --name siyuan-mcp-server \
  siyuan-mcp-server
```

3. **‰ΩøÁî® Docker Compose**
```bash
# ÈÖçÁΩÆÁéØÂ¢ÉÂèòÈáè
cp env.example .env
# ÁºñËæë .env Êñá‰ª∂

# ÂêØÂä®ÊúçÂä°
docker-compose up -d
```



### üìÑ ËÆ∏ÂèØËØÅ

MIT License

---

**[‚¨Ü ËøîÂõûÈ°∂ÈÉ®](#ÊÄùÊ∫êÁ¨îËÆ∞-mcp-ÊúçÂä°Âô®--siyuan-mcp-server)**